defmodule CCXT.Types.Schema.LeverageTier do
  @moduledoc """
  Auto-generated schema for `CCXT.Types.LeverageTier`.

  Source: priv/ccxt/ts/src/base/types.ts

  ## Fields

  - `tier` - number() (optional)
  - `symbol` - String.t() | nil (optional)
  - `currency` - String.t() | nil (optional)
  - `min_notional` - number() (optional)
  - `max_notional` - number() (optional)
  - `maintenance_margin_rate` - number() (optional)
  - `max_leverage` - number() (optional)
  - `raw` - any()

  ## Usage

  This module is used by `CCXT.Types.LeverageTier`:

      defmodule CCXT.Types.LeverageTier do
        use CCXT.Types.Schema.LeverageTier
      end

  Do not edit this file manually - it will be overwritten by `mix ccxt.gen.types`.

  """

  @fields [
    %{name: :tier, optional: true, source: "tier", type: "number()"},
    %{name: :symbol, optional: true, source: "symbol", type: "String.t() | nil"},
    %{name: :currency, optional: true, source: "currency", type: "String.t() | nil"},
    %{name: :min_notional, optional: true, source: "minNotional", type: "number()"},
    %{name: :max_notional, optional: true, source: "maxNotional", type: "number()"},
    %{
      name: :maintenance_margin_rate,
      optional: true,
      source: "maintenanceMarginRate",
      type: "number()"
    },
    %{name: :max_leverage, optional: true, source: "maxLeverage", type: "number()"},
    %{name: :raw, optional: false, source: "info", type: "any()"}
  ]
  @type_spec_str """
  %__MODULE__{
    tier: number() | nil,
    symbol: String.t() | nil,
    currency: String.t() | nil,
    min_notional: number() | nil,
    max_notional: number() | nil,
    maintenance_margin_rate: number() | nil,
    max_leverage: number() | nil,
    raw: any()
  }
  """
  @type_spec Code.string_to_quoted!(@type_spec_str)

  defmacro __using__(opts) do
    fields = @fields
    type_spec = @type_spec
    struct_defaults = Keyword.get(opts, :struct_defaults, [])
    field_names = Enum.map(fields, & &1.name)

    struct_fields =
      Enum.map(field_names, fn name ->
        if Keyword.has_key?(struct_defaults, name) do
          {name, Keyword.fetch!(struct_defaults, name)}
        else
          name
        end
      end)

    quote do
      import CCXT.Types.Helpers, only: [get_value: 2, get_camel_value: 3]

      @fields unquote(Macro.escape(fields))
      @type_spec unquote(Macro.escape(type_spec))
      @type t :: unquote(type_spec)
      defstruct unquote(struct_fields)
      @spec from_map(map()) :: t()
      def from_map(map) when is_map(map) do
        %__MODULE__{
          tier: get_value(map, :tier),
          symbol: get_value(map, :symbol),
          currency: get_value(map, :currency),
          min_notional: get_camel_value(map, :min_notional, :minNotional),
          max_notional: get_camel_value(map, :max_notional, :maxNotional),
          maintenance_margin_rate: get_camel_value(map, :maintenance_margin_rate, :maintenanceMarginRate),
          max_leverage: get_camel_value(map, :max_leverage, :maxLeverage),
          raw: get_camel_value(map, :raw, :info)
        }
      end

      defoverridable from_map: 1
    end
  end
end
