defmodule CCXT.Types.Schema.CurrencyInterface do
  @moduledoc """
  Auto-generated schema for `CCXT.Types.CurrencyInterface`.

  Source: priv/ccxt/ts/src/base/types.ts

  ## Fields

  - `id` - String.t()
  - `code` - String.t()
  - `numeric_id` - integer() | nil (optional)
  - `precision` - number()
  - `type` - String.t() | nil (optional)
  - `margin` - boolean() | nil (optional)
  - `name` - String.t() | nil (optional)
  - `active` - boolean() | nil (optional)
  - `deposit` - boolean() | nil (optional)
  - `withdraw` - boolean() | nil (optional)
  - `fee` - number() | nil (optional)
  - `networks` - %{optional(String.t()) => any()}
  - `raw` - any()

  ## Usage

  This module is used by `CCXT.Types.CurrencyInterface`:

      defmodule CCXT.Types.CurrencyInterface do
        use CCXT.Types.Schema.CurrencyInterface
      end

  Do not edit this file manually - it will be overwritten by `mix ccxt.gen.types`.

  """

  Module.register_attribute(__MODULE__, :fields, persist: true)

  @fields [
    %{name: :id, optional: false, source: "id", type: "String.t()"},
    %{name: :code, optional: false, source: "code", type: "String.t()"},
    %{name: :numeric_id, optional: true, source: "numericId", type: "integer() | nil"},
    %{name: :precision, optional: false, source: "precision", type: "number()"},
    %{name: :type, optional: true, source: "type", type: "String.t() | nil"},
    %{name: :margin, optional: true, source: "margin", type: "boolean() | nil"},
    %{name: :name, optional: true, source: "name", type: "String.t() | nil"},
    %{name: :active, optional: true, source: "active", type: "boolean() | nil"},
    %{name: :deposit, optional: true, source: "deposit", type: "boolean() | nil"},
    %{name: :withdraw, optional: true, source: "withdraw", type: "boolean() | nil"},
    %{name: :fee, optional: true, source: "fee", type: "number() | nil"},
    %{
      name: :networks,
      optional: false,
      source: "networks",
      type: "%{optional(String.t()) => any()}"
    },
    %{name: :raw, optional: false, source: "info", type: "any()"}
  ]
  @type_spec_str """
  %__MODULE__{
    id: String.t(),
    code: String.t(),
    numeric_id: integer() | nil,
    precision: number(),
    type: String.t() | nil,
    margin: boolean() | nil,
    name: String.t() | nil,
    active: boolean() | nil,
    deposit: boolean() | nil,
    withdraw: boolean() | nil,
    fee: number() | nil,
    networks: %{optional(String.t()) => any()},
    raw: any()
  }
  """
  @type_spec Code.string_to_quoted!(@type_spec_str)

  defmacro __using__(opts) do
    fields = @fields
    type_spec = @type_spec
    struct_defaults = Keyword.get(opts, :struct_defaults, [])
    field_names = Enum.map(fields, & &1.name)

    struct_fields =
      Enum.map(field_names, fn name ->
        if Keyword.has_key?(struct_defaults, name) do
          {name, Keyword.fetch!(struct_defaults, name)}
        else
          name
        end
      end)

    quote do
      import CCXT.Types.Helpers, only: [get_value: 2, get_camel_value: 3]

      @fields unquote(Macro.escape(fields))
      @type_spec unquote(Macro.escape(type_spec))
      @type t :: unquote(type_spec)
      defstruct unquote(struct_fields)
      @spec from_map(map()) :: t()
      def from_map(map) when is_map(map) do
        %__MODULE__{
          id: get_value(map, :id),
          code: get_value(map, :code),
          numeric_id: get_camel_value(map, :numeric_id, :numericId),
          precision: get_value(map, :precision),
          type: get_value(map, :type),
          margin: get_value(map, :margin),
          name: get_value(map, :name),
          active: get_value(map, :active),
          deposit: get_value(map, :deposit),
          withdraw: get_value(map, :withdraw),
          fee: get_value(map, :fee),
          networks: get_value(map, :networks),
          raw: get_camel_value(map, :raw, :info)
        }
      end

      defoverridable from_map: 1
    end
  end
end
