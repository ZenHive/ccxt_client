# Kraken Futures Exchange Specification
#
# Auto-generated by: mix ccxt.extract krakenfutures
# CCXT version: 4.5.34
# Spec format version: 1
#
# Review before use:
# - signing: Detected from sign() method, verify with testnet
# - endpoints: Raw paths extracted, map to unified API as needed
# - exceptions: Extracted (exact, broad, HTTP status codes)
# - features/options: Extracted from describe()
# - classification: Set to :supported initially, promote after validation
#
%{
  api_param_requirements: nil,
  certified: false,
  classification: :pro,
  comment: nil,
  countries: [
    "US"
  ],
  currencies: %{},
  currency_aliases: %{
    "BCHSV" => "BSV",
    "XBT" => "BTC"
  },
  dex: false,
  enable_rate_limit: true,
  endpoint_extraction_stats: %{
    "capturedMethods" => 37,
    "coveragePercent" => 100,
    "enabledMethods" => 39,
    "excluded" => [
      %{
        "method" => "fetchFundingRate",
        "reason" => "emulated (returns cached data, no HTTP call)"
      },
      %{
        "method" => "fetchMarketLeverageTiers",
        "reason" => "emulated (returns cached data, no HTTP call)"
      }
    ],
    "excludedMethods" => 2,
    "extractableMethods" => 37,
    "failures" => []
  },
  endpoints: [
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :post,
      name: :cancel_all_orders,
      param_mappings: %{},
      params: [
        :symbol
      ],
      path: "/cancelallorders",
      response_transformer: {:extract_path, ["cancelStatus", "orderEvents"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "timeout" => 1
      },
      market_type: :swap,
      method: :post,
      name: :cancel_all_orders_after,
      param_mappings: %{},
      params: [
        :timeout
      ],
      path: "/cancelallordersafter",
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :post,
      name: :cancel_order,
      param_mappings: %{
        "id" => "order_id"
      },
      params: [
        :id,
        :symbol
      ],
      path: "/cancelorder",
      response_transformer: {:extract_path, ["cancelStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "batchOrder" => [
          %{
            "order" => "cancel",
            "order_id" => "test-order-id"
          }
        ]
      },
      market_type: :swap,
      method: :post,
      name: :cancel_orders,
      param_mappings: %{},
      params: [
        :ids,
        :symbol
      ],
      path: "/batchorder",
      response_transformer: {:extract_path, ["batchStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "lmt"
      },
      market_type: :swap,
      method: :post,
      name: :create_limit_order,
      param_mappings: %{
        "amount" => "size",
        "price" => "limitPrice"
      },
      params: [
        :symbol,
        :side,
        :amount,
        :price
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "mkt"
      },
      market_type: :swap,
      method: :post,
      name: :create_market_order,
      param_mappings: %{
        "amount" => "size"
      },
      params: [
        :symbol,
        :side,
        :amount,
        :price
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "lmt"
      },
      market_type: :swap,
      method: :post,
      name: :create_order,
      param_mappings: %{
        "amount" => "size",
        "price" => "limitPrice"
      },
      params: [
        :symbol,
        :type,
        :side,
        :amount,
        :price
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "post"
      },
      market_type: :swap,
      method: :post,
      name: :create_post_only_order,
      param_mappings: %{
        "amount" => "size",
        "price" => "limitPrice"
      },
      params: [
        :symbol,
        :type,
        :side,
        :amount,
        :price
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "lmt",
        "reduceOnly" => true,
        "symbol" => "BTCUSDT"
      },
      market_type: :swap,
      method: :post,
      name: :create_reduce_only_order,
      param_mappings: %{
        "amount" => "size",
        "price" => "limitPrice"
      },
      params: [
        :symbol,
        :type,
        :side,
        :amount,
        :price
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "stp",
        "symbol" => "BTCUSDT",
        "triggerDirection" => "below",
        "triggerSignal" => "last"
      },
      market_type: :swap,
      method: :post,
      name: :create_stop_limit_order,
      param_mappings: %{
        "amount" => "size",
        "price" => "limitPrice",
        "triggerPrice" => "stopPrice"
      },
      params: [
        :symbol,
        :side,
        :amount,
        :price,
        :triggerPrice
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "stp",
        "symbol" => "BTCUSDT",
        "triggerDirection" => "below",
        "triggerSignal" => "last"
      },
      market_type: :swap,
      method: :post,
      name: :create_stop_market_order,
      param_mappings: %{
        "amount" => "size",
        "triggerPrice" => "stopPrice"
      },
      params: [
        :symbol,
        :side,
        :amount,
        :triggerPrice
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "stp",
        "symbol" => "BTCUSDT",
        "triggerDirection" => "below",
        "triggerSignal" => "last"
      },
      market_type: :swap,
      method: :post,
      name: :create_stop_order,
      param_mappings: %{
        "amount" => "size",
        "price" => "limitPrice",
        "triggerPrice" => "stopPrice"
      },
      params: [
        :symbol,
        :type,
        :side,
        :amount,
        :price,
        :triggerPrice
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderType" => "stp",
        "symbol" => "BTCUSDT",
        "triggerDirection" => "below",
        "triggerSignal" => "last"
      },
      market_type: :swap,
      method: :post,
      name: :create_trigger_order,
      param_mappings: %{
        "amount" => "size",
        "price" => "limitPrice",
        "triggerPrice" => "stopPrice"
      },
      params: [
        :symbol,
        :type,
        :side,
        :amount,
        :price,
        :triggerPrice
      ],
      path: "/sendorder",
      response_transformer: {:extract_path, ["sendStatus"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :post,
      name: :edit_order,
      param_mappings: %{
        "amount" => "size",
        "id" => "orderId",
        "price" => "limitPrice"
      },
      params: [
        :id,
        :symbol,
        :type,
        :side,
        :amount,
        :price
      ],
      path: "/editorder",
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_balance,
      param_mappings: %{},
      params: [],
      path: "/accounts",
      source: :intercepted
    },
    %{
      api_section: "history",
      auth: false,
      base_url: "https://futures.kraken.com/api/history/",
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_canceled_orders,
      param_mappings: %{},
      params: [
        :symbol,
        :since,
        :limit
      ],
      path: "/v2/orders",
      response_transformer: {:extract_path, ["elements"]},
      source: :intercepted
    },
    %{
      api_section: "history",
      auth: false,
      base_url: "https://futures.kraken.com/api/history/",
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_closed_orders,
      param_mappings: %{},
      params: [
        :symbol,
        :since,
        :limit
      ],
      path: "/v2/orders",
      response_transformer: {:extract_path, ["elements"]},
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      default_params: %{
        "symbol" => "BTCUSDT"
      },
      market_type: :swap,
      method: :get,
      name: :fetch_funding_rate_history,
      param_mappings: %{},
      params: [
        :symbol,
        :since,
        :limit
      ],
      path: "/v4/historicalfundingrates",
      response_transformer: {:extract_path, ["rates"]},
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_funding_rates,
      param_mappings: %{},
      params: [
        :symbols
      ],
      path: "/tickers",
      response_transformer: {:extract_path, ["tickers"]},
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_l2_order_book,
      param_mappings: %{},
      params: [
        :symbol,
        :limit
      ],
      path: "/orderbook",
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "symbol" => "BTCUSDT"
      },
      market_type: :swap,
      method: :get,
      name: :fetch_leverage,
      param_mappings: %{},
      params: [
        :symbol
      ],
      path: "/leveragepreferences",
      response_transformer: {:extract_path_unwrap, ["leveragePreferences"]},
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_leverage_tiers,
      param_mappings: %{},
      params: [
        :symbols
      ],
      path: "/instruments",
      response_transformer: {:extract_path, ["instruments"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_leverages,
      param_mappings: %{},
      params: [
        :symbols
      ],
      path: "/leveragepreferences",
      response_transformer: {:extract_path, ["leveragePreferences"]},
      source: :intercepted
    },
    %{
      api_section: "charts",
      auth: false,
      base_url: "https://futures.kraken.com/api/charts/",
      cost: 1,
      default_params: %{
        "interval" => "1m",
        "price_type" => "mark",
        "symbol" => "BTCUSDT"
      },
      market_type: :swap,
      method: :get,
      name: :fetch_mark_ohlcv,
      param_mappings: %{
        "timeframe" => "interval"
      },
      params: [
        :symbol,
        :timeframe,
        :since,
        :limit
      ],
      path: "/v1/{price_type}/{symbol}/{interval}",
      response_transformer: {:extract_path, ["candles"]},
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_markets,
      param_mappings: %{},
      params: [],
      path: "/instruments",
      response_transformer: {:extract_path, ["instruments"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_my_trades,
      param_mappings: %{},
      params: [
        :symbol,
        :since,
        :limit
      ],
      path: "/fills",
      source: :intercepted
    },
    %{
      api_section: "charts",
      auth: false,
      base_url: "https://futures.kraken.com/api/charts/",
      cost: 1,
      default_params: %{
        "price_type" => "trade",
        "to" => "<generated>"
      },
      market_type: :swap,
      method: :get,
      name: :fetch_ohlcv,
      param_mappings: %{
        "since" => "from",
        "timeframe" => "interval"
      },
      params: [
        :symbol,
        :timeframe,
        :since,
        :limit
      ],
      path: "/v1/{price_type}/{symbol}/{interval}",
      response_transformer: {:extract_path, ["candles"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_open_orders,
      param_mappings: %{},
      params: [
        :symbol,
        :since,
        :limit
      ],
      path: "/openorders",
      response_transformer: {:extract_path, ["openOrders"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "orderIds" => [
          "test-order-id"
        ]
      },
      market_type: :swap,
      method: :get,
      name: :fetch_order,
      param_mappings: %{},
      params: [
        :id,
        :symbol
      ],
      path: "/orders/status",
      response_transformer: {:extract_path_unwrap, ["orders"]},
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_order_book,
      param_mappings: %{},
      params: [
        :symbol,
        :limit
      ],
      path: "/orderbook",
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_orders,
      param_mappings: %{},
      params: [
        :symbol,
        :since,
        :limit
      ],
      path: "/orders/status",
      response_transformer: {:extract_path, ["orders"]},
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_positions,
      param_mappings: %{},
      params: [
        :symbols
      ],
      path: "/openpositions",
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_ticker,
      param_mappings: %{},
      params: [
        :symbol
      ],
      path: "/tickers",
      response_transformer: {:extract_path_unwrap, ["tickers"]},
      source: :intercepted
    },
    %{
      api_section: "public",
      auth: false,
      cost: 1,
      market_type: :swap,
      method: :get,
      name: :fetch_tickers,
      param_mappings: %{},
      params: [
        :symbols
      ],
      path: "/tickers",
      response_transformer: {:extract_path, ["tickers"]},
      source: :intercepted
    },
    %{
      api_section: "history",
      auth: false,
      base_url: "https://futures.kraken.com/api/history/",
      cost: 1,
      default_params: %{
        "sort" => "asc"
      },
      market_type: :swap,
      method: :get,
      name: :fetch_trades,
      param_mappings: %{
        "limit" => "count"
      },
      params: [
        :symbol,
        :since,
        :limit
      ],
      path: "/market/{symbol}/executions",
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "symbol" => "BTCUSDT"
      },
      market_type: :swap,
      method: :put,
      name: :set_leverage,
      param_mappings: %{
        "leverage" => "maxLeverage"
      },
      params: [
        :leverage,
        :symbol
      ],
      path: "/leveragepreferences",
      source: :intercepted
    },
    %{
      api_section: "private",
      auth: true,
      cost: 1,
      default_params: %{
        "fromAccount" => "cash"
      },
      market_type: :swap,
      method: :post,
      name: :transfer,
      param_mappings: %{
        "code" => "unit"
      },
      params: [
        :code,
        :amount,
        :fromAccount,
        :toAccount
      ],
      path: "/transfer",
      source: :intercepted
    }
  ],
  error_code_details: %{
    "Bad Request" => %{
      description: "The URL contains invalid characters. (Please encode the json URL parameter)",
      type: :invalid_parameters
    },
    "Json Parse Error" => %{
      description: nil,
      type: :exchange_error
    },
    "Server Error" => %{
      description: nil,
      type: :exchange_error
    },
    "Unavailable" => %{
      description: "https://github.com/ccxt/ccxt/issues/24338",
      type: :network_error
    },
    "accountInactive" => %{
      description: "When account has no trade history / no order history. Should this error be ignored in some cases?",
      type: :exchange_error
    },
    "apiLimitExceeded" => %{
      description: nil,
      type: :rate_limited
    },
    "authenticationError" => %{
      description: nil,
      type: :invalid_credentials
    },
    "insufficientFunds" => %{
      description: nil,
      type: :insufficient_balance
    },
    "invalidAccount" => %{
      description: "the fromAccount or the toAccount are invalid",
      type: :invalid_parameters
    },
    "invalidAmount" => %{
      description: nil,
      type: :invalid_parameters
    },
    "invalidArgument" => %{
      description: nil,
      type: :invalid_parameters
    },
    "invalidUnit" => %{
      description: nil,
      type: :invalid_parameters
    },
    "marketUnavailable" => %{
      description: nil,
      type: :market_closed
    },
    "nonceBelowThreshold" => %{
      description: nil,
      type: :invalid_credentials
    },
    "nonceDuplicate" => %{
      description: nil,
      type: :invalid_credentials
    },
    "notFound" => %{
      description: nil,
      type: :invalid_parameters
    },
    "requiredArgumentMissing" => %{
      description: nil,
      type: :invalid_parameters
    },
    "unavailable" => %{
      description: nil,
      type: :network_error
    },
    "unknownError" => %{
      description: nil,
      type: :exchange_error
    }
  },
  error_codes: %{
    "Bad Request" => :invalid_parameters,
    "Json Parse Error" => :exchange_error,
    "Server Error" => :exchange_error,
    "Unavailable" => :network_error,
    "accountInactive" => :exchange_error,
    "apiLimitExceeded" => :rate_limited,
    "authenticationError" => :invalid_credentials,
    "insufficientFunds" => :insufficient_balance,
    "invalidAccount" => :invalid_parameters,
    "invalidAmount" => :invalid_parameters,
    "invalidArgument" => :invalid_parameters,
    "invalidUnit" => :invalid_parameters,
    "marketUnavailable" => :market_closed,
    "nonceBelowThreshold" => :invalid_credentials,
    "nonceDuplicate" => :invalid_credentials,
    "notFound" => :invalid_parameters,
    "requiredArgumentMissing" => :invalid_parameters,
    "unavailable" => :network_error,
    "unknownError" => :exchange_error
  },
  exceptions: %{
    broad: %{
      "invalidArgument" => :bad_request,
      "nonceBelowThreshold" => :invalid_nonce,
      "nonceDuplicate" => :invalid_nonce
    },
    exact: %{
      "Bad Request" => :bad_request,
      "Json Parse Error" => :exchange_error,
      "Server Error" => :exchange_error,
      "Unavailable" => :exchange_not_available,
      "accountInactive" => :exchange_error,
      "apiLimitExceeded" => :rate_limit_exceeded,
      "authenticationError" => :authentication_error,
      "insufficientFunds" => :insufficient_funds,
      "invalidAccount" => :bad_request,
      "invalidAmount" => :bad_request,
      "invalidUnit" => :bad_request,
      "marketUnavailable" => :contract_unavailable,
      "nonceBelowThreshold" => :invalid_nonce,
      "nonceDuplicate" => :invalid_nonce,
      "notFound" => :bad_request,
      "requiredArgumentMissing" => :bad_request,
      "unavailable" => :exchange_not_available,
      "unknownError" => :exchange_error
    }
  },
  exchange_options: %{
    "access" => %{
      "history" => %{
        "GET" => %{
          "account-log" => "private",
          "accountlogcsv" => "private",
          "executions" => "private",
          "orders" => "private",
          "triggers" => "private"
        }
      }
    },
    "defaultNetworkCodeReplacements" => %{
      "BRC20" => %{
        "BRC20" => "BTC"
      },
      "CRO" => %{
        "CRC20" => "CRONOS"
      },
      "ETH" => %{
        "ERC20" => "ETH"
      },
      "TRX" => %{
        "TRC20" => "TRX"
      }
    },
    "fetchTrades" => %{
      "method" => "historyGetMarketSymbolExecutions"
    },
    "networksById" => %{},
    "settlementCurrencies" => %{
      "flex" => [
        "USDT",
        "BTC",
        "USD",
        "GBP",
        "EUR",
        "USDC"
      ]
    },
    "symbol" => %{
      "quoteIds" => [
        "USD",
        "XBT"
      ],
      "reversed" => false
    },
    "versions" => %{
      "charts" => %{
        "GET" => %{
          "{price_type}/{symbol}/{interval}" => "v1"
        }
      },
      "history" => %{
        "GET" => %{
          "accountlogcsv" => "v2",
          "executions" => "v2",
          "orders" => "v2",
          "triggers" => "v2"
        }
      },
      "public" => %{
        "GET" => %{
          "historicalfundingrates" => "v4"
        }
      }
    }
  },
  extended_metadata: %{
    fees_url: "https://support.kraken.com/hc/en-us/articles/360022835771-Transaction-fees-and-rebates-for-Kraken-Futures",
    limits: %{
      "amount" => %{},
      "cost" => %{},
      "leverage" => %{},
      "price" => %{}
    },
    logo_url: "https://user-images.githubusercontent.com/24300605/81436764-b22fd580-9172-11ea-9703-742783e6376d.jpg"
  },
  extracted_metadata: %{
    ccxt_version: "4.5.34"
  },
  features: %{
    default: %{
      create_order: %{
        hedged: false,
        iceberg: false,
        leverage: false,
        margin_mode: false,
        market_buy_by_cost: false,
        market_buy_requires_price: false,
        self_trade_prevention: false,
        stop_loss_price: true,
        take_profit_price: true,
        time_in_force: %{
          fok: true,
          gtd: false,
          ioc: true,
          po: true
        },
        trailing: false,
        trigger_direction: false,
        trigger_price: true,
        trigger_price_type: %{
          index: true,
          last: true,
          mark: true
        }
      },
      create_orders: %{
        max: 100
      },
      fetch_closed_orders: %{
        margin_mode: false,
        symbol_required: false,
        trailing: false,
        trigger: false
      },
      fetch_my_trades: %{
        margin_mode: false,
        symbol_required: false,
        until_days: 100000
      },
      fetch_ohlcv: %{
        limit: 2000
      },
      fetch_open_orders: %{
        margin_mode: false,
        symbol_required: false,
        trailing: false,
        trigger: false
      },
      sandbox: true
    },
    future: %{
      inverse: %{
        extends: "default"
      },
      linear: %{
        extends: "default"
      }
    },
    swap: %{
      inverse: %{
        extends: "default"
      },
      linear: %{
        extends: "default"
      }
    }
  },
  fees: %{
    trading: %{
      maker: 0.0002,
      percentage: true,
      taker: 0.0005,
      tier_based: true,
      tiers: %{
        maker: [
          %{
            fee: 0.0002,
            volume: 0
          },
          %{
            fee: 0.0015,
            volume: 100000
          },
          %{
            fee: 1.25e-4,
            volume: 1000000
          },
          %{
            fee: 0.0001,
            volume: 5000000
          },
          %{
            fee: 7.5e-5,
            volume: 10000000
          },
          %{
            fee: 5.0e-5,
            volume: 20000000
          },
          %{
            fee: 2.5e-5,
            volume: 50000000
          },
          %{
            fee: 0,
            volume: 100000000
          }
        ],
        taker: [
          %{
            fee: 0.0005,
            volume: 0
          },
          %{
            fee: 0.0004,
            volume: 100000
          },
          %{
            fee: 0.0003,
            volume: 1000000
          },
          %{
            fee: 2.5e-4,
            volume: 5000000
          },
          %{
            fee: 0.0002,
            volume: 10000000
          },
          %{
            fee: 1.5e-4,
            volume: 20000000
          },
          %{
            fee: 1.25e-4,
            volume: 50000000
          },
          %{
            fee: 0.0001,
            volume: 100000000
          }
        ]
      }
    }
  },
  handle_content_type_application_zip: nil,
  handle_errors_source: "handleErrors(code, reason, url, method, headers, body, response, requestHeaders, requestBody) {\n        if (response === undefined) {\n            return undefined;\n        }\n        if (code === 429) {\n            throw new errors.DDoSProtection(this.id + ' ' + body);\n        }\n        const errors$1 = this.safeValue(response, 'errors');\n        const firstError = this.safeValue(errors$1, 0);\n        const firtErrorMessage = this.safeString(firstError, 'message');\n        const message = this.safeString(response, 'error', firtErrorMessage);\n        if (message === undefined) {\n            return undefined;\n        }\n        const feedback = this.id + ' ' + body;\n        this.throwExactlyMatchedException(this.exceptions['exact'], message, feedback);\n        this.throwBroadlyMatchedException(this.exceptions['broad'], message, feedback);\n        if (code === 400) {\n            throw new errors.BadRequest(feedback);\n        }\n        throw new errors.ExchangeError(feedback); // unknown message\n    }",
  has: %{
    add_margin: false,
    borrow_cross_margin: false,
    borrow_isolated_margin: false,
    borrow_margin: false,
    c_o_r_s: false,
    cancel_all_orders: true,
    cancel_all_orders_after: true,
    cancel_all_orders_ws: false,
    cancel_order: true,
    cancel_order_with_client_order_id: false,
    cancel_order_ws: false,
    cancel_orders: true,
    cancel_orders_with_client_order_id: false,
    cancel_orders_ws: false,
    close_all_positions: false,
    close_position: false,
    create_deposit_address: false,
    create_limit_buy_order: false,
    create_limit_buy_order_ws: false,
    create_limit_order: true,
    create_limit_order_ws: false,
    create_limit_sell_order: false,
    create_limit_sell_order_ws: false,
    create_market_buy_order: false,
    create_market_buy_order_with_cost: false,
    create_market_buy_order_with_cost_ws: false,
    create_market_buy_order_ws: false,
    create_market_order: true,
    create_market_order_with_cost: false,
    create_market_order_with_cost_ws: false,
    create_market_order_ws: true,
    create_market_sell_order: false,
    create_market_sell_order_with_cost: false,
    create_market_sell_order_with_cost_ws: false,
    create_market_sell_order_ws: false,
    create_order: true,
    create_order_with_take_profit_and_stop_loss: false,
    create_order_with_take_profit_and_stop_loss_ws: false,
    create_order_ws: false,
    create_orders: false,
    create_post_only_order: true,
    create_post_only_order_ws: false,
    create_reduce_only_order: true,
    create_reduce_only_order_ws: false,
    create_stop_limit_order: true,
    create_stop_limit_order_ws: false,
    create_stop_loss_order: false,
    create_stop_loss_order_ws: false,
    create_stop_market_order: true,
    create_stop_market_order_ws: false,
    create_stop_order: true,
    create_stop_order_ws: false,
    create_take_profit_order: false,
    create_take_profit_order_ws: false,
    create_trailing_amount_order: false,
    create_trailing_amount_order_ws: false,
    create_trailing_percent_order: false,
    create_trailing_percent_order_ws: false,
    create_trigger_order: true,
    create_trigger_order_ws: false,
    deposit: false,
    edit_order: true,
    edit_order_with_client_order_id: false,
    edit_order_ws: false,
    edit_orders: false,
    fetch_accounts: false,
    fetch_balance: true,
    fetch_balance_ws: false,
    fetch_bids_asks: false,
    fetch_borrow_interest: false,
    fetch_borrow_rate: false,
    fetch_borrow_rate_histories: false,
    fetch_borrow_rate_history: false,
    fetch_borrow_rates: false,
    fetch_borrow_rates_per_symbol: false,
    fetch_canceled_and_closed_orders: false,
    fetch_canceled_orders: true,
    fetch_closed_order: false,
    fetch_closed_orders: true,
    fetch_closed_orders_ws: false,
    fetch_convert_currencies: false,
    fetch_convert_quote: false,
    fetch_convert_trade: false,
    fetch_convert_trade_history: false,
    fetch_cross_borrow_rate: false,
    fetch_cross_borrow_rates: false,
    fetch_currencies: false,
    fetch_currencies_ws: true,
    fetch_deposit: false,
    fetch_deposit_address: false,
    fetch_deposit_addresses: false,
    fetch_deposit_addresses_by_network: false,
    fetch_deposit_withdraw_fee: false,
    fetch_deposit_withdraw_fees: false,
    fetch_deposits: false,
    fetch_deposits_withdrawals: false,
    fetch_deposits_ws: false,
    fetch_funding_history: false,
    fetch_funding_interval: false,
    fetch_funding_intervals: false,
    fetch_funding_rate: true,
    fetch_funding_rate_history: true,
    fetch_funding_rates: true,
    fetch_greeks: false,
    fetch_index_ohlcv: false,
    fetch_isolated_borrow_rate: false,
    fetch_isolated_borrow_rates: false,
    fetch_isolated_positions: false,
    fetch_l2_order_book: true,
    fetch_l3_order_book: false,
    fetch_last_prices: false,
    fetch_ledger: false,
    fetch_ledger_entry: false,
    fetch_leverage: true,
    fetch_leverage_tiers: true,
    fetch_leverages: true,
    fetch_liquidations: false,
    fetch_long_short_ratio: false,
    fetch_long_short_ratio_history: false,
    fetch_margin_adjustment_history: false,
    fetch_margin_mode: false,
    fetch_margin_modes: false,
    fetch_mark_ohlcv: true,
    fetch_mark_prices: false,
    fetch_market_leverage_tiers: true,
    fetch_markets: true,
    fetch_markets_ws: false,
    fetch_my_liquidations: false,
    fetch_my_settlement_history: false,
    fetch_my_trades: true,
    fetch_my_trades_ws: false,
    fetch_ohlcv: true,
    fetch_ohlcv_ws: false,
    fetch_open_interest: false,
    fetch_open_interest_history: false,
    fetch_open_interests: false,
    fetch_open_order: false,
    fetch_open_orders: true,
    fetch_open_orders_ws: false,
    fetch_option: false,
    fetch_option_chain: false,
    fetch_order: true,
    fetch_order_book: true,
    fetch_order_book_ws: false,
    fetch_order_books: false,
    fetch_order_trades: false,
    fetch_order_with_client_order_id: false,
    fetch_order_ws: false,
    fetch_orders: true,
    fetch_orders_by_status: false,
    fetch_orders_ws: false,
    fetch_position: false,
    fetch_position_history: false,
    fetch_position_mode: false,
    fetch_position_ws: false,
    fetch_positions: true,
    fetch_positions_for_symbol: false,
    fetch_positions_for_symbol_ws: false,
    fetch_positions_history: false,
    fetch_positions_risk: false,
    fetch_positions_ws: false,
    fetch_premium_index_ohlcv: false,
    fetch_settlement_history: false,
    fetch_status: false,
    fetch_ticker: true,
    fetch_ticker_ws: false,
    fetch_tickers: true,
    fetch_tickers_ws: false,
    fetch_time: false,
    fetch_trades: true,
    fetch_trades_ws: false,
    fetch_trading_fee: false,
    fetch_trading_fees: false,
    fetch_trading_fees_ws: false,
    fetch_trading_limits: false,
    fetch_transaction_fee: false,
    fetch_transaction_fees: false,
    fetch_transactions: false,
    fetch_transfer: false,
    fetch_transfers: false,
    fetch_underlying_assets: false,
    fetch_volatility_history: false,
    fetch_withdraw_addresses: false,
    fetch_withdrawal: false,
    fetch_withdrawal_whitelist: false,
    fetch_withdrawals: false,
    fetch_withdrawals_ws: false,
    future: true,
    margin: false,
    option: false,
    private_api: true,
    public_api: true,
    reduce_margin: false,
    repay_cross_margin: false,
    repay_isolated_margin: false,
    sandbox: true,
    set_leverage: true,
    set_margin: false,
    set_margin_mode: false,
    set_position_mode: false,
    sign_in: false,
    spot: false,
    swap: true,
    transfer: true,
    un_watch_my_trades: false,
    un_watch_ohlcv: false,
    un_watch_ohlcv_for_symbols: false,
    un_watch_order_book: false,
    un_watch_order_book_for_symbols: false,
    un_watch_orders: false,
    un_watch_positions: false,
    un_watch_ticker: false,
    un_watch_tickers: false,
    un_watch_trades: false,
    un_watch_trades_for_symbols: false,
    watch_balance: true,
    watch_bids_asks: true,
    watch_liquidations: false,
    watch_liquidations_for_symbols: false,
    watch_my_liquidations: false,
    watch_my_liquidations_for_symbols: false,
    watch_my_trades: true,
    watch_ohlcv: false,
    watch_ohlcv_for_symbols: false,
    watch_order_book: true,
    watch_order_book_for_symbols: true,
    watch_orders: true,
    watch_orders_for_symbols: false,
    watch_position: false,
    watch_positions: true,
    watch_status: false,
    watch_ticker: true,
    watch_tickers: true,
    watch_trades: true,
    watch_trades_for_symbols: true,
    withdraw: false,
    ws: false
  },
  http_config: nil,
  id: "krakenfutures",
  markets: nil,
  name: "Kraken Futures",
  ohlcv_timestamp_resolution: :seconds,
  options: %{
    access: %{
      "history" => %{
        "GET" => %{
          "account-log" => "private",
          "accountlogcsv" => "private",
          "executions" => "private",
          "orders" => "private",
          "triggers" => "private"
        }
      }
    },
    fetch_trades: %{
      "method" => "historyGetMarketSymbolExecutions"
    },
    settlement_currencies: %{
      "flex" => [
        "USDT",
        "BTC",
        "USD",
        "GBP",
        "EUR",
        "USDC"
      ]
    },
    symbol: %{
      "quoteIds" => [
        "USD",
        "XBT"
      ],
      "reversed" => false
    },
    versions: %{
      "charts" => %{
        "GET" => %{
          "{price_type}/{symbol}/{interval}" => "v1"
        }
      },
      "history" => %{
        "GET" => %{
          "accountlogcsv" => "v2",
          "executions" => "v2",
          "orders" => "v2",
          "triggers" => "v2"
        }
      },
      "public" => %{
        "GET" => %{
          "historicalfundingrates" => "v4"
        }
      }
    }
  },
  order_mappings: %{
    side_format: :lowercase,
    side_key: "side",
    type_format: nil,
    type_key: "orderType"
  },
  param_mappings: %{
    "amount" => "size",
    "code" => "unit",
    "id" => "orderId",
    "leverage" => "maxLeverage",
    "limit" => "count",
    "price" => "limitPrice",
    "since" => "from",
    "timeframe" => "interval",
    "triggerPrice" => "stopPrice"
  },
  parse_methods: [
    %{
      "comment" => nil,
      "examples" => [],
      "line_end" => 2846,
      "line_start" => 2821,
      "mappings" => [],
      "name" => "parseAccount",
      "signature" => "parseAccount (account)",
      "source" => "parseAccount (account) {\n        const accountByType: Dict = {\n            'main': 'cash',\n            'funding': 'cash',\n            'future': 'cash',\n            'futures': 'cash',\n            'cashAccount': 'cash',\n            'multiCollateralMarginAccount': 'flex',\n            'multiCollateral': 'flex',\n            'multiCollateralMargin': 'flex',\n        };\n        if (account in accountByType) {\n            return accountByType[account];\n        } else if (account in this.markets) {\n            const market = this.market (account);\n            const marketId = market['id'];\n            const splitId = marketId.split ('_');\n            if (market['inverse']) {\n                return 'fi_' + this.safeString (splitId, 1);\n            } else {\n                return 'fv_' + this.safeString (splitId, 1);\n            }\n        } else {\n            return account;\n        }\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"balances\": {\n            \"eur\": \"0.0\",\n            \"gbp\": \"0.0\",\n            \"bch\": \"0.0\",\n            \"xrp\": \"2.20188538338\",\n            \"usd\": \"0.0\",\n            \"eth\": \"0.0\",\n            \"usdt\": \"0.0\",\n            \"ltc\": \"0.0\",\n            \"usdc\": \"0.0\",\n            \"xbt\": \"0.0\"\n        },\n        \"type\": \"cashAccount\"\n    }",
        "{\n        \"auxiliary\": {\n            \"usd\": \"0\",\n            \"pv\": \"11.0\",\n            \"pnl\": \"0.0\",\n            \"af\": \"11.0\",\n            \"funding\": \"0.0\"\n        },\n        \"marginRequirements\": { im: '0.0', mm: '0.0', lt: '0.0', tt: \"0.0\" },\n        \"triggerEstimates\": { im: '0', mm: '0', lt: \"0\", tt: \"0\" },\n        \"balances\": { xrp: \"11.0\" },\n        \"currency\": \"xrp\",\n        \"type\": \"marginAccount\"\n    }",
        "{\n       \"currencies\": {\n            \"USDT\": {\n                \"quantity\": \"1\",\n                \"value\": \"1.0001\",\n                \"collateral\": \"0.9477197625\",\n                \"available\": \"1.0\"\n             }\n       },\n       \"initialMargin\": \"0.0\",\n       \"initialMarginWithOrders\": \"0.0\",\n       \"maintenanceMargin\": \"0.0\",\n       \"balanceValue\": \"1.0\",\n       \"portfolioValue\": \"1.0\",\n       \"collateralValue\": \"0.95\",\n       \"pnl\": \"0.0\",\n       \"unrealizedFunding\": \"0.0\",\n       \"totalUnrealized\": \"0.0\",\n       \"totalUnrealizedAsMargin\": \"0.0\",\n       \"availableMargin\": \"0.95\",\n       \"marginEquity\": \"0.95\",\n       \"type\": \"multiCollateralMarginAccount\"\n    }"
      ],
      "line_end" => 2416,
      "line_start" => 2323,
      "mappings" => [],
      "name" => "parseBalance",
      "signature" => "parseBalance (response): Balances",
      "source" => "parseBalance (response): Balances {\n        //\n        // cashAccount\n        //\n        //    {\n        //        \"balances\": {\n        //            \"eur\": \"0.0\",\n        //            \"gbp\": \"0.0\",\n        //            \"bch\": \"0.0\",\n        //            \"xrp\": \"2.20188538338\",\n        //            \"usd\": \"0.0\",\n        //            \"eth\": \"0.0\",\n        //            \"usdt\": \"0.0\",\n        //            \"ltc\": \"0.0\",\n        //            \"usdc\": \"0.0\",\n        //            \"xbt\": \"0.0\"\n        //        },\n        //        \"type\": \"cashAccount\"\n        //    }\n        //\n        // marginAccount e,g, fi_xrpusd\n        //\n        //    {\n        //        \"auxiliary\": {\n        //            \"usd\": \"0\",\n        //            \"pv\": \"11.0\",\n        //            \"pnl\": \"0.0\",\n        //            \"af\": \"11.0\",\n        //            \"funding\": \"0.0\"\n        //        },\n        //        \"marginRequirements\": { im: '0.0', mm: '0.0', lt: '0.0', tt: \"0.0\" },\n        //        \"triggerEstimates\": { im: '0', mm: '0', lt: \"0\", tt: \"0\" },\n        //        \"balances\": { xrp: \"11.0\" },\n        //        \"currency\": \"xrp\",\n        //        \"type\": \"marginAccount\"\n        //    }\n        //\n        // flex/multiCollateralMarginAccount\n        //\n        //    {\n        //       \"currencies\": {\n        //            \"USDT\": {\n        //                \"quantity\": \"1\",\n        //                \"value\": \"1.0001\",\n        //                \"collateral\": \"0.9477197625\",\n        //                \"available\": \"1.0\"\n        //             }\n        //       },\n        //       \"initialMargin\": \"0.0\",\n        //       \"initialMarginWithOrders\": \"0.0\",\n        //       \"maintenanceMargin\": \"0.0\",\n        //       \"balanceValue\": \"1.0\",\n        //       \"portfolioValue\": \"1.0\",\n        //       \"collateralValue\": \"0.95\",\n        //       \"pnl\": \"0.0\",\n        //       \"unrealizedFunding\": \"0.0\",\n        //       \"totalUnrealized\": \"0.0\",\n        //       \"totalUnrealizedAsMargin\": \"0.0\",\n        //       \"availableMargin\": \"0.95\",\n        //       \"marginEquity\": \"0.95\",\n        //       \"type\": \"multiCollateralMarginAccount\"\n        //    }\n        //\n        const accountType = this.safeString2 (response, 'accountType', 'type');\n        const isFlex = (accountType === 'multiCollateralMarginAccount');\n        const isCash = (accountType === 'cashAccount');\n        const balances = this.safeValue2 (response, 'balances', 'currencies', {});\n        const result: Dict = {};\n        const currencyIds = Object.keys (balances);\n        for (let i = 0; i < currencyIds.length; i++) {\n            const currencyId = currencyIds[i];\n            const balance = balances[currencyId];\n            const code = this.safeCurrencyCode (currencyId);\n            const splitCode = code.split ('_');\n            const codeLength = splitCode.length;\n            if (codeLength > 1) {\n                continue;   // Removes contract codes like PI_XRPUSD\n            }\n            const account = this.account ();\n            if (isFlex) {\n                account['total'] = this.safeString (balance, 'quantity');\n                account['free'] = this.safeString (balance, 'available');\n            } else if (isCash) {\n                account['used'] = '0.0';\n                account['total'] = balance;\n            } else {\n                const auxiliary = this.safeValue (response, 'auxiliary');\n                account['free'] = this.safeString (auxiliary, 'af');\n                account['total'] = this.safeString (auxiliary, 'pv');\n            }\n            result[code] = account;\n        }\n        return this.safeBalance (result);\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n         \"symbol\": \"PF_ENJUSD\",\n         \"last\": 0.0433,\n         \"lastTime\": \"2025-10-22T11:02:25.599Z\",\n         \"tag\": \"perpetual\",\n         \"pair\": \"ENJ:USD\",\n         \"markPrice\": 0.0434,\n         \"bid\": 0.0433,\n         \"bidSize\": 4609,\n         \"ask\": 0.0435,\n         \"askSize\": 4609,\n         \"vol24h\": 1696,\n         \"volumeQuote\": 73.5216,\n         \"openInterest\": 72513.00000000000,\n         \"open24h\": 0.0435,\n         \"high24h\": 0.0435,\n         \"low24h\": 0.0433,\n         \"lastSize\": 1272,\n         \"fundingRate\": -0.000000756414717067,\n         \"fundingRatePrediction\": 0.000000195218676,\n         \"suspended\": false,\n         \"indexPrice\": 0.043391,\n         \"postOnly\": false,\n         \"change24h\": -0.46\n     }"
      ],
      "line_end" => 2514,
      "line_start" => 2448,
      "mappings" => [
        %{
          "comment" => nil,
          "key" => "info",
          "value" => "ticker"
        },
        %{
          "comment" => nil,
          "key" => "symbol",
          "value" => "symbol"
        },
        %{
          "comment" => nil,
          "key" => "markPrice",
          "value" => "this.parseNumber (markPriceString)"
        },
        %{
          "comment" => nil,
          "key" => "indexPrice",
          "value" => "this.safeNumber (ticker, 'indexPrice')"
        },
        %{
          "comment" => nil,
          "key" => "interestRate",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "estimatedSettlePrice",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "timestamp",
          "value" => "timestamp"
        },
        %{
          "comment" => nil,
          "key" => "datetime",
          "value" => "this.iso8601 (timestamp)"
        },
        %{
          "comment" => nil,
          "key" => "fundingRate",
          "value" => "this.parseNumber (fundingRateResult)"
        },
        %{
          "comment" => nil,
          "key" => "fundingTimestamp",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "fundingDatetime",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "nextFundingRate",
          "value" => "this.parseNumber (nextFundingRateResult)"
        },
        %{
          "comment" => nil,
          "key" => "nextFundingTimestamp",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "nextFundingDatetime",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "previousFundingRate",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "previousFundingTimestamp",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "previousFundingDatetime",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "interval",
          "value" => "'1h'"
        }
      ],
      "name" => "parseFundingRate",
      "signature" => "parseFundingRate (ticker, market: Market = undefined): FundingRate",
      "source" => "parseFundingRate (ticker, market: Market = undefined): FundingRate {\n        //\n        //     {\n        //         \"symbol\": \"PF_ENJUSD\",\n        //         \"last\": 0.0433,\n        //         \"lastTime\": \"2025-10-22T11:02:25.599Z\",\n        //         \"tag\": \"perpetual\",\n        //         \"pair\": \"ENJ:USD\",\n        //         \"markPrice\": 0.0434,\n        //         \"bid\": 0.0433,\n        //         \"bidSize\": 4609,\n        //         \"ask\": 0.0435,\n        //         \"askSize\": 4609,\n        //         \"vol24h\": 1696,\n        //         \"volumeQuote\": 73.5216,\n        //         \"openInterest\": 72513.00000000000,\n        //         \"open24h\": 0.0435,\n        //         \"high24h\": 0.0435,\n        //         \"low24h\": 0.0433,\n        //         \"lastSize\": 1272,\n        //         \"fundingRate\": -0.000000756414717067,\n        //         \"fundingRatePrediction\": 0.000000195218676,\n        //         \"suspended\": false,\n        //         \"indexPrice\": 0.043391,\n        //         \"postOnly\": false,\n        //         \"change24h\": -0.46\n        //     }\n        //\n        const marketId = this.safeString (ticker, 'symbol');\n        const symbol = this.symbol (marketId);\n        const timestamp = this.parse8601 (this.safeString (ticker, 'lastTime'));\n        const markPriceString = this.safeString (ticker, 'markPrice');\n        const fundingRateString = this.safeString (ticker, 'fundingRate');\n        let fundingRateResult = Precise.stringDiv (fundingRateString, markPriceString);\n        const nextFundingRateString = this.safeString (ticker, 'fundingRatePrediction');\n        let nextFundingRateResult = Precise.stringDiv (nextFundingRateString, markPriceString);\n        if (Precise.stringGt (fundingRateResult, '0.25')) {\n            fundingRateResult = '0.25';\n        } else if (Precise.stringLt (fundingRateResult, '-0.25')) {\n            fundingRateResult = '-0.25';\n        }\n        if (Precise.stringGt (nextFundingRateResult, '0.25')) {\n            nextFundingRateResult = '0.25';\n        } else if (Precise.stringLt (nextFundingRateResult, '-0.25')) {\n            nextFundingRateResult = '-0.25';\n        }\n        return {\n            'info': ticker,\n            'symbol': symbol,\n            'markPrice': this.parseNumber (markPriceString),\n            'indexPrice': this.safeNumber (ticker, 'indexPrice'),\n            'interestRate': undefined,\n            'estimatedSettlePrice': undefined,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'fundingRate': this.parseNumber (fundingRateResult),\n            'fundingTimestamp': undefined,\n            'fundingDatetime': undefined,\n            'nextFundingRate': this.parseNumber (nextFundingRateResult),\n            'nextFundingTimestamp': undefined,\n            'nextFundingDatetime': undefined,\n            'previousFundingRate': undefined,\n            'previousFundingTimestamp': undefined,\n            'previousFundingDatetime': undefined,\n            'interval': '1h',\n        } as FundingRate;\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [],
      "line_end" => 3004,
      "line_start" => 2994,
      "mappings" => [
        %{
          "comment" => nil,
          "key" => "info",
          "value" => "leverage"
        },
        %{
          "comment" => nil,
          "key" => "symbol",
          "value" => "this.safeSymbol (marketId, market)"
        },
        %{
          "comment" => nil,
          "key" => "marginMode",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "longLeverage",
          "value" => "leverageValue"
        },
        %{
          "comment" => nil,
          "key" => "shortLeverage",
          "value" => "leverageValue"
        }
      ],
      "name" => "parseLeverage",
      "signature" => "parseLeverage (leverage: Dict, market: Market = undefined): Leverage",
      "source" => "parseLeverage (leverage: Dict, market: Market = undefined): Leverage {\n        const marketId = this.safeString (leverage, 'symbol');\n        const leverageValue = this.safeInteger (leverage, 'maxLeverage');\n        return {\n            'info': leverage,\n            'symbol': this.safeSymbol (marketId, market),\n            'marginMode': undefined,\n            'longLeverage': leverageValue,\n            'shortLeverage': leverageValue,\n        } as Leverage;\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"symbol\": \"fi_ethusd_180928\",\n        \"type\": \"futures_inverse\",  // futures_vanilla  // spot index\n        \"underlying\": \"rr_ethusd\",\n        \"lastTradingTime\": \"2018-09-28T15:00:00.000Z\",\n        \"tickSize\": 0.1,\n        \"contractSize\": 1,\n        \"tradeable\": true,\n        \"marginLevels\": [\n            {\n                \"contracts\":0,\n                \"initialMargin\":0.02,\n                \"maintenanceMargin\":0.01\n            },\n            {\n                \"contracts\":250000,\n                \"initialMargin\":0.04,\n                \"maintenanceMargin\":0.02\n            },\n            ...\n        ],\n        \"isin\": \"GB00JVMLMP88\",\n        \"retailMarginLevels\": [\n            {\n                \"contracts\": 0,\n                \"initialMargin\": 0.5,\n                \"maintenanceMargin\": 0.25\n            }\n        ],\n        \"tags\": [],\n    }"
      ],
      "line_end" => 2796,
      "line_start" => 2728,
      "mappings" => [],
      "name" => "parseMarketLeverageTiers",
      "signature" => "parseMarketLeverageTiers (info, market: Market = undefined): LeverageTier[]",
      "source" => "parseMarketLeverageTiers (info, market: Market = undefined): LeverageTier[] {\n        /**\n         * @method\n         * @ignore\n         * @param info Exchange market response for 1 market\n         * @param market CCXT market\n         */\n        //\n        //    {\n        //        \"symbol\": \"fi_ethusd_180928\",\n        //        \"type\": \"futures_inverse\",  // futures_vanilla  // spot index\n        //        \"underlying\": \"rr_ethusd\",\n        //        \"lastTradingTime\": \"2018-09-28T15:00:00.000Z\",\n        //        \"tickSize\": 0.1,\n        //        \"contractSize\": 1,\n        //        \"tradeable\": true,\n        //        \"marginLevels\": [\n        //            {\n        //                \"contracts\":0,\n        //                \"initialMargin\":0.02,\n        //                \"maintenanceMargin\":0.01\n        //            },\n        //            {\n        //                \"contracts\":250000,\n        //                \"initialMargin\":0.04,\n        //                \"maintenanceMargin\":0.02\n        //            },\n        //            ...\n        //        ],\n        //        \"isin\": \"GB00JVMLMP88\",\n        //        \"retailMarginLevels\": [\n        //            {\n        //                \"contracts\": 0,\n        //                \"initialMargin\": 0.5,\n        //                \"maintenanceMargin\": 0.25\n        //            }\n        //        ],\n        //        \"tags\": [],\n        //    }\n        //\n        const marginLevels = this.safeValue (info, 'marginLevels');\n        const marketId = this.safeString (info, 'symbol');\n        market = this.safeMarket (marketId, market);\n        const tiers = [];\n        if (marginLevels === undefined) {\n            return tiers;\n        }\n        for (let i = 0; i < marginLevels.length; i++) {\n            const tier = marginLevels[i];\n            const initialMargin = this.safeString (tier, 'initialMargin');\n            const minNotional = this.safeNumber2 (tier, 'numNonContractUnits', 'contracts');\n            if (i !== 0) {\n                const tiersLength = tiers.length;\n                const previousTier = tiers[tiersLength - 1];\n                previousTier['maxNotional'] = minNotional;\n            }\n            tiers.push ({\n                'tier': this.sum (i, 1),\n                'symbol': this.safeSymbol (marketId, market),\n                'currency': market['quote'],\n                'minNotional': minNotional,\n                'maxNotional': undefined,\n                'maintenanceMarginRate': this.safeNumber (tier, 'maintenanceMargin'),\n                'maxLeverage': this.parseNumber (Precise.stringDiv ('1', initialMargin)),\n                'info': tier,\n            });\n        }\n        return tiers as LeverageTier[];\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"time\": 1645198500000,\n        \"open\": \"309.15000000000\",\n        \"high\": \"309.15000000000\",\n        \"low\": \"308.70000000000\",\n        \"close\": \"308.85000000000\",\n        \"volume\": 0\n    }"
      ],
      "line_end" => 795,
      "line_start" => 776,
      "mappings" => [],
      "name" => "parseOHLCV",
      "signature" => "parseOHLCV (ohlcv, market: Market = undefined): OHLCV",
      "source" => "parseOHLCV (ohlcv, market: Market = undefined): OHLCV {\n        //\n        //    {\n        //        \"time\": 1645198500000,\n        //        \"open\": \"309.15000000000\",\n        //        \"high\": \"309.15000000000\",\n        //        \"low\": \"308.70000000000\",\n        //        \"close\": \"308.85000000000\",\n        //        \"volume\": 0\n        //    }\n        //\n        return [\n            this.safeInteger (ohlcv, 'time'),       // unix timestamp in milliseconds\n            this.safeNumber (ohlcv, 'open'),        // open price\n            this.safeNumber (ohlcv, 'high'),        // highest price\n            this.safeNumber (ohlcv, 'low'),         // lowest price\n            this.safeNumber (ohlcv, 'close'),       // close price\n            this.safeNumber (ohlcv, 'volume'),      // trading volume, undefined for mark or index price\n        ];\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"order_id\": \"179f9af8-e45e-469d-b3e9-2fd4675cb7d0\",\n        \"status\": \"placed\",\n        \"receivedTime\": \"2019-09-05T16:33:50.734Z\",\n        \"orderEvents\": [\n            {\n                \"uid\": \"614a5298-0071-450f-83c6-0617ce8c6bc4\",\n                \"order\": {\n                    \"orderId\": \"179f9af8-e45e-469d-b3e9-2fd4675cb7d0\",\n                    \"cliOrdId\": null,\n                    \"type\": \"lmt\",\n                    \"symbol\": \"pi_xbtusd\",\n                    \"side\": \"buy\",\n                    \"quantity\": 10000,\n                    \"filled\": 0,\n                    \"limitPrice\": 9400,\n                    \"reduceOnly\": false,\n                    \"timestamp\": \"2019-09-05T16:33:50.734Z\",\n                    \"lastUpdateTimestamp\": \"2019-09-05T16:33:50.734Z\"\n                },\n                \"reducedQuantity\": null,\n                \"reason\": \"WOULD_NOT_REDUCE_POSITION\", // REJECTED\n                \"type\": \"PLACE\"\n            }\n        ]\n    }",
        "{\n        \"order_id\": \"1abfd3c6-af93-4b30-91cc-e4a93797f3f5\",\n        \"status\": \"placed\",\n        \"receivedTime\": \"2019-12-05T10:20:50.701Z\",\n        \"orderEvents\": [\n            {\n                \"orderTrigger\": {\n                    \"uid\": \"1abfd3c6-af93-4b30-91cc-e4a93797f3f5\",\n                    \"clientId\":null,\n                    \"type\": \"lmt\",                                // \"ioc\" if stop market\n                    \"symbol\": \"pi_xbtusd\",\n                    \"side\": \"buy\",\n                    \"quantity\":10,\n                    \"limitPrice\":15000,\n                    \"triggerPrice\":9500,\n                    \"triggerSide\": \"trigger_below\",\n                    \"triggerSignal\": \"mark_price\",\n                    \"reduceOnly\":false,\n                    \"timestamp\": \"2019-12-05T10:20:50.701Z\",\n                    \"lastUpdateTimestamp\": \"2019-12-05T10:20:50.701Z\"\n                },\n                \"type\": \"PLACE\"\n            }\n        ]\n    }",
        "{\n        \"order_id\": \"61ca5732-3478-42fe-8362-abbfd9465294\",\n        \"status\": \"placed\",\n        \"receivedTime\": \"2019-12-11T17:17:33.888Z\",\n        \"orderEvents\": [\n            {\n                \"executionId\": \"e1ec9f63-2338-4c44-b40a-43486c6732d7\",\n                \"price\": 7244.5,\n                \"amount\": 10,\n                \"orderPriorEdit\": null,\n                \"orderPriorExecution\": {\n                    \"orderId\": \"61ca5732-3478-42fe-8362-abbfd9465294\",\n                    \"cliOrdId\": null,\n                    \"type\": \"lmt\",\n                    \"symbol\": \"pi_xbtusd\",\n                    \"side\": \"buy\",\n                    \"quantity\": 10,\n                    \"filled\": 0,\n                    \"limitPrice\": 7500,\n                    \"reduceOnly\": false,\n                    \"timestamp\": \"2019-12-11T17:17:33.888Z\",\n                    \"lastUpdateTimestamp\": \"2019-12-11T17:17:33.888Z\"\n                },\n                \"takerReducedQuantity\": null,\n                \"type\": \"EXECUTION\"\n            }\n        ]\n    }",
        "{\n        \"status\": \"edited\",\n        \"orderId\": \"022774bc-2c4a-4f26-9317-436c8d85746d\",\n        \"receivedTime\": \"2019-09-05T16:47:47.521Z\",\n        \"orderEvents\": [\n            {\n                \"old\": {\n                    \"orderId\": \"022774bc-2c4a-4f26-9317-436c8d85746d\",\n                    \"cliOrdId\":null,\n                    \"type\": \"lmt\",\n                    \"symbol\": \"pi_xbtusd\",\n                    \"side\": \"buy\",\n                    \"quantity\":1000,\n                    \"filled\":0,\n                    \"limitPrice\":9400.0,\n                    \"reduceOnly\":false,\n                    \"timestamp\": \"2019-09-05T16:41:35.173Z\",\n                    \"lastUpdateTimestamp\": \"2019-09-05T16:41:35.173Z\"\n                },\n                \"new\": {\n                    \"orderId\": \"022774bc-2c4a-4f26-9317-436c8d85746d\",\n                    \"cliOrdId\": null,\n                    \"type\": \"lmt\",\n                    \"symbol\": \"pi_xbtusd\",\n                    \"side\": \"buy\",\n                    \"quantity\": 1501,\n                    \"filled\": 0,\n                    \"limitPrice\": 7200,\n                    \"reduceOnly\": false,\n                    \"timestamp\": \"2019-09-05T16:41:35.173Z\",\n                    \"lastUpdateTimestamp\": \"2019-09-05T16:47:47.519Z\"\n                },\n                \"reducedQuantity\": null,\n                \"type\": \"EDIT\"\n            }\n        ]\n    }",
        "{\n        \"status\": \"cancelled\",\n        \"orderEvents\": [\n            {\n                \"uid\": \"85c40002-3f20-4e87-9302-262626c3531b\",\n                \"order\": {\n                    \"orderId\": \"85c40002-3f20-4e87-9302-262626c3531b\",\n                    \"cliOrdId\": null,\n                    \"type\": \"lmt\",\n                    \"symbol\": \"pi_xbtusd\",\n                    \"side\": \"buy\",\n                    \"quantity\": 1000,\n                    \"filled\": 0,\n                    \"limitPrice\": 10144,\n                    \"stopPrice\": null,\n                    \"reduceOnly\": false,\n                    \"timestamp\": \"2019-08-01T15:26:27.790Z\"\n                },\n                \"type\": \"CANCEL\"\n            }\n        ]\n    }"
      ],
      "line_end" => 2150,
      "line_start" => 1701,
      "mappings" => [
        %{
          "comment" => nil,
          "key" => "info",
          "value" => "order"
        },
        %{
          "comment" => nil,
          "key" => "id",
          "value" => "this.safeString (orderDictFromFetchOrder, 'orderId')"
        },
        %{
          "comment" => nil,
          "key" => "clientOrderId",
          "value" => "this.safeStringN (orderDictFromFetchOrder, [ 'cliOrdId' ])"
        },
        %{
          "comment" => nil,
          "key" => "timestamp",
          "value" => "this.parse8601 (datetime)"
        },
        %{
          "comment" => nil,
          "key" => "datetime",
          "value" => "datetime"
        },
        %{
          "comment" => nil,
          "key" => "lastTradeTimestamp",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "lastUpdateTimestamp",
          "value" => "this.parse8601 (this.safeString (orderDictFromFetchOrder, 'lastUpdateTimestamp'))"
        },
        %{
          "comment" => nil,
          "key" => "symbol",
          "value" => "this.safeSymbol (this.safeString (orderDictFromFetchOrder, 'symbol'), market)"
        },
        %{
          "comment" => nil,
          "key" => "type",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "timeInForce",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "postOnly",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "reduceOnly",
          "value" => "this.safeBool (orderDictFromFetchOrder, 'reduceOnly')"
        },
        %{
          "comment" => nil,
          "key" => "side",
          "value" => "this.safeString (orderDictFromFetchOrder, 'side')"
        },
        %{
          "comment" => nil,
          "key" => "price",
          "value" => "this.safeString (orderDictFromFetchOrder, 'limitPrice')"
        },
        %{
          "comment" => nil,
          "key" => "triggerPrice",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "amount",
          "value" => "this.safeString (orderDictFromFetchOrder, 'quantity')"
        },
        %{
          "comment" => nil,
          "key" => "cost",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "average",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "filled",
          "value" => "this.safeString (orderDictFromFetchOrder, 'filled')"
        },
        %{
          "comment" => nil,
          "key" => "remaining",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "status",
          "value" => "this.parseOrderStatus (innerStatus)"
        },
        %{
          "comment" => nil,
          "key" => "fee",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "fees",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "trades",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "status",
          "value" => "'rejected'"
        },
        %{
          "comment" => nil,
          "key" => "id",
          "value" => "id"
        },
        %{
          "comment" => nil,
          "key" => "clientOrderId",
          "value" => "this.safeStringN (details, [ 'clientOrderId', 'clientId', 'cliOrdId' ])"
        },
        %{
          "comment" => nil,
          "key" => "timestamp",
          "value" => "ts"
        },
        %{
          "comment" => nil,
          "key" => "datetime",
          "value" => "this.iso8601 (ts)"
        },
        %{
          "comment" => nil,
          "key" => "lastUpdateTimestamp",
          "value" => "this.safeInteger (details, 'lastUpdateTimestamp', lastUpdateTimestamp)"
        },
        %{
          "comment" => nil,
          "key" => "symbol",
          "value" => "symbol"
        },
        %{
          "comment" => nil,
          "key" => "type",
          "value" => "this.parseOrderType (type)"
        },
        %{
          "comment" => nil,
          "key" => "timeInForce",
          "value" => "timeInForce"
        },
        %{
          "comment" => nil,
          "key" => "postOnly",
          "value" => "type === 'post'"
        },
        %{
          "comment" => nil,
          "key" => "reduceOnly",
          "value" => "this.safeBool2 (details, 'reduceOnly', 'reduce_only')"
        },
        %{
          "comment" => nil,
          "key" => "side",
          "value" => "this.safeStringLower2 (details, 'side', 'direction')"
        },
        %{
          "comment" => nil,
          "key" => "price",
          "value" => "price"
        },
        %{
          "comment" => nil,
          "key" => "triggerPrice",
          "value" => "this.safeString (details, 'triggerPrice')"
        },
        %{
          "comment" => nil,
          "key" => "amount",
          "value" => "amount"
        },
        %{
          "comment" => nil,
          "key" => "cost",
          "value" => "cost"
        },
        %{
          "comment" => nil,
          "key" => "average",
          "value" => "average"
        },
        %{
          "comment" => nil,
          "key" => "filled",
          "value" => "filled"
        },
        %{
          "comment" => nil,
          "key" => "remaining",
          "value" => "remaining"
        },
        %{
          "comment" => nil,
          "key" => "status",
          "value" => "status"
        },
        %{
          "comment" => nil,
          "key" => "trades",
          "value" => "trades"
        }
      ],
      "name" => "parseOrder",
      "signature" => "parseOrder (order: Dict, market: Market = undefined): Order",
      "source" => "parseOrder (order: Dict, market: Market = undefined): Order {\n        //\n        // LIMIT\n        //\n        //    {\n        //        \"order_id\": \"179f9af8-e45e-469d-b3e9-2fd4675cb7d0\",\n        //        \"status\": \"placed\",\n        //        \"receivedTime\": \"2019-09-05T16:33:50.734Z\",\n        //        \"orderEvents\": [\n        //            {\n        //                \"uid\": \"614a5298-0071-450f-83c6-0617ce8c6bc4\",\n        //                \"order\": {\n        //                    \"orderId\": \"179f9af8-e45e-469d-b3e9-2fd4675cb7d0\",\n        //                    \"cliOrdId\": null,\n        //                    \"type\": \"lmt\",\n        //                    \"symbol\": \"pi_xbtusd\",\n        //                    \"side\": \"buy\",\n        //                    \"quantity\": 10000,\n        //                    \"filled\": 0,\n        //                    \"limitPrice\": 9400,\n        //                    \"reduceOnly\": false,\n        //                    \"timestamp\": \"2019-09-05T16:33:50.734Z\",\n        //                    \"lastUpdateTimestamp\": \"2019-09-05T16:33:50.734Z\"\n        //                },\n        //                \"reducedQuantity\": null,\n        //                \"reason\": \"WOULD_NOT_REDUCE_POSITION\", // REJECTED\n        //                \"type\": \"PLACE\"\n        //            }\n        //        ]\n        //    }\n        //\n        // CONDITIONAL\n        //\n        //    {\n        //        \"order_id\": \"1abfd3c6-af93-4b30-91cc-e4a93797f3f5\",\n        //        \"status\": \"placed\",\n        //        \"receivedTime\": \"2019-12-05T10:20:50.701Z\",\n        //        \"orderEvents\": [\n        //            {\n        //                \"orderTrigger\": {\n        //                    \"uid\": \"1abfd3c6-af93-4b30-91cc-e4a93797f3f5\",\n        //                    \"clientId\":null,\n        //                    \"type\": \"lmt\",                                // \"ioc\" if stop market\n        //                    \"symbol\": \"pi_xbtusd\",\n        //                    \"side\": \"buy\",\n        //                    \"quantity\":10,\n        //                    \"limitPrice\":15000,\n        //                    \"triggerPrice\":9500,\n        //                    \"triggerSide\": \"trigger_below\",\n        //                    \"triggerSignal\": \"mark_price\",\n        //                    \"reduceOnly\":false,\n        //                    \"timestamp\": \"2019-12-05T10:20:50.701Z\",\n        //                    \"lastUpdateTimestamp\": \"2019-12-05T10:20:50.701Z\"\n        //                },\n        //                \"type\": \"PLACE\"\n        //            }\n        //        ]\n        //    }\n        //\n        // EXECUTION\n        //\n        //    {\n        //        \"order_id\": \"61ca5732-3478-42fe-8362-abbfd9465294\",\n        //        \"status\": \"placed\",\n        //        \"receivedTime\": \"2019-12-11T17:17:33.888Z\",\n        //        \"orderEvents\": [\n        //            {\n        //                \"executionId\": \"e1ec9f63-2338-4c44-b40a-43486c6732d7\",\n        //                \"price\": 7244.5,\n        //                \"amount\": 10,\n        //                \"orderPriorEdit\": null,\n        //                \"orderPriorExecution\": {\n        //                    \"orderId\": \"61ca5732-3478-42fe-8362-abbfd9465294\",\n        //                    \"cliOrdId\": null,\n        //                    \"type\": \"lmt\",\n        //                    \"symbol\": \"pi_xbtusd\",\n        //                    \"side\": \"buy\",\n        //                    \"quantity\": 10,\n        //                    \"filled\": 0,\n        //                    \"limitPrice\": 7500,\n        //                    \"reduceOnly\": false,\n        //                    \"timestamp\": \"2019-12-11T17:17:33.888Z\",\n        //                    \"lastUpdateTimestamp\": \"2019-12-11T17:17:33.888Z\"\n        //                },\n        //                \"takerReducedQuantity\": null,\n        //                \"type\": \"EXECUTION\"\n        //            }\n        //        ]\n        //    }\n        //\n        // EDIT ORDER\n        //\n        //    {\n        //        \"status\": \"edited\",\n        //        \"orderId\": \"022774bc-2c4a-4f26-9317-436c8d85746d\",\n        //        \"receivedTime\": \"2019-09-05T16:47:47.521Z\",\n        //        \"orderEvents\": [\n        //            {\n        //                \"old\": {\n        //                    \"orderId\": \"022774bc-2c4a-4f26-9317-436c8d85746d\",\n        //                    \"cliOrdId\":null,\n        //                    \"type\": \"lmt\",\n        //                    \"symbol\": \"pi_xbtusd\",\n        //                    \"side\": \"buy\",\n        //                    \"quantity\":1000,\n        //                    \"filled\":0,\n        //                    \"limitPrice\":9400.0,\n        //                    \"reduceOnly\":false,\n        //                    \"timestamp\": \"2019-09-05T16:41:35.173Z\",\n        //                    \"lastUpdateTimestamp\": \"2019-09-05T16:41:35.173Z\"\n        //                },\n        //                \"new\": {\n        //                    \"orderId\": \"022774bc-2c4a-4f26-9317-436c8d85746d\",\n        //                    \"cliOrdId\": null,\n        //                    \"type\": \"lmt\",\n        //                    \"symbol\": \"pi_xbtusd\",\n        //                    \"side\": \"buy\",\n        //                    \"quantity\": 1501,\n        //                    \"filled\": 0,\n        //                    \"limitPrice\": 7200,\n        //                    \"reduceOnly\": false,\n        //                    \"timestamp\": \"2019-09-05T16:41:35.173Z\",\n        //                    \"lastUpdateTimestamp\": \"2019-09-05T16:47:47.519Z\"\n        //                },\n        //                \"reducedQuantity\": null,\n        //                \"type\": \"EDIT\"\n        //            }\n        //        ]\n        //    }\n        //\n        // CANCEL ORDER\n        //\n        //    {\n        //        \"status\": \"cancelled\",\n        //        \"orderEvents\": [\n        //            {\n        //                \"uid\": \"85c40002-3f20-4e87-9302-262626c3531b\",\n        //                \"order\": {\n        //                    \"orderId\": \"85c40002-3f20-4e87-9302-262626c3531b\",\n        //                    \"cliOrdId\": null,\n        //                    \"type\": \"lmt\",\n        //                    \"symbol\": \"pi_xbtusd\",\n        //                    \"side\": \"buy\",\n        //                    \"quantity\": 1000,\n        //                    \"filled\": 0,\n        //                    \"limitPrice\": 10144,\n        //                    \"stopPrice\": null,\n        //                    \"reduceOnly\": false,\n        //                    \"timestamp\": \"2019-08-01T15:26:27.790Z\"\n        //                },\n        //                \"type\": \"CANCEL\"\n        //            }\n        //        ]\n        //    }\n        //\n        // cancelAllOrders\n        //\n        //    {\n        //        \"orderId\": \"85c40002-3f20-4e87-9302-262626c3531b\",\n        //        \"cliOrdId\": null,\n        //        \"type\": \"lmt\",\n        //        \"symbol\": \"pi_xbtusd\",\n        //        \"side\": \"buy\",\n        //        \"quantity\": 1000,\n        //        \"filled\": 0,\n        //        \"limitPrice\": 10144,\n        //        \"stopPrice\": null,\n        //        \"reduceOnly\": false,\n        //        \"timestamp\": \"2019-08-01T15:26:27.790Z\"\n        //    }\n        //\n        // FETCH OPEN ORDERS\n        //\n        //    {\n        //        \"order_id\": \"59302619-41d2-4f0b-941f-7e7914760ad3\",\n        //        \"symbol\": \"pi_xbtusd\",\n        //        \"side\": \"sell\",\n        //        \"orderType\": \"lmt\",\n        //        \"limitPrice\": 10640,\n        //        \"unfilledSize\": 304,\n        //        \"receivedTime\": \"2019-09-05T17:01:17.410Z\",\n        //        \"status\": \"untouched\",\n        //        \"filledSize\": 0,\n        //        \"reduceOnly\": true,\n        //        \"lastUpdateTime\": \"2019-09-05T17:01:17.410Z\"\n        //    }\n        //\n        // createOrders error\n        //    {\n        //       \"status\": \"requiredArgumentMissing\",\n        //       \"orderEvents\": []\n        //    }\n        // closed orders\n        //    {\n        //        uid: '2f00cd63-e61d-44f8-8569-adabde885941',\n        //        timestamp: '1707258274849',\n        //        event: {\n        //          OrderPlaced: {\n        //            order: {\n        //              uid: '85805e01-9eed-4395-8360-ed1a228237c9',\n        //              accountUid: '406142dd-7c5c-4a8b-acbc-5f16eca30009',\n        //              tradeable: 'PF_LTCUSD',\n        //              direction: 'Buy',\n        //              quantity: '0',\n        //              filled: '0.1',\n        //              timestamp: '1707258274849',\n        //              limitPrice: '69.2200000000',\n        //              orderType: 'IoC',\n        //              clientId: '',\n        //              reduceOnly: false,\n        //              lastUpdateTimestamp: '1707258274849'\n        //            },\n        //            reason: 'new_user_order',\n        //            reducedQuantity: '',\n        //            algoId: ''\n        //          }\n        //        }\n        //    }\n        //\n        //   {\n        //     uid: '85805e01-9eed-4395-8360-ed1a228237c9',\n        //     accountUid: '406142dd-7c5c-4a8b-acbc-5f16eca30009',\n        //     tradeable: 'PF_LTCUSD',\n        //     direction: 'Buy',\n        //     quantity: '0',\n        //     filled: '0.1',\n        //     timestamp: '1707258274849',\n        //     limitPrice: '69.2200000000',\n        //     orderType: 'IoC',\n        //     clientId: '',\n        //     reduceOnly: false,\n        //     lastUpdateTimestamp: '1707258274849',\n        //     status: 'closed'\n        //   }\n        //\n        // order: {\n        //     type: 'ORDER',\n        //     orderId: 'a111f276-95fd-47fc-b77b-709c5ab2e9e1',\n        //     cliOrdId: null,\n        //     symbol: 'PF_LTCUSD',\n        //     side: 'buy',\n        //     quantity: '0.1',\n        //     filled: '0',\n        //     limitPrice: '40',\n        //     reduceOnly: false,\n        //     timestamp: '2026-02-13T12:09:03.738Z',\n        //     lastUpdateTimestamp: '2026-02-13T12:09:03.738Z'\n        // },\n        //     status: 'ENTERED_BOOK',\n        //     updateReason: null,\n        //     error: null\n        // }\n        //\n        const orderDictFromFetchOrder = this.safeDict (order, 'order');\n        if (orderDictFromFetchOrder !== undefined) {\n            // order: {\n            //     type: 'ORDER',\n            //     orderId: 'a111f276-95fd-47fc-b77b-709c5ab2e9e1',\n            //     cliOrdId: null,\n            //     symbol: 'PF_LTCUSD',\n            //     side: 'buy',\n            //     quantity: '0.1',\n            //     filled: '0',\n            //     limitPrice: '40',\n            //     reduceOnly: false,\n            //     timestamp: '2026-02-13T12:09:03.738Z',\n            //     lastUpdateTimestamp: '2026-02-13T12:09:03.738Z'\n            // },\n            //     status: 'ENTERED_BOOK',\n            //     updateReason: null,\n            //     error: null\n            //\n            const datetime = this.safeString (orderDictFromFetchOrder, 'timestamp');\n            const innerStatus = this.safeString (order, 'status');\n            return this.safeOrder ({\n                'info': order,\n                'id': this.safeString (orderDictFromFetchOrder, 'orderId'),\n                'clientOrderId': this.safeStringN (orderDictFromFetchOrder, [ 'cliOrdId' ]),\n                'timestamp': this.parse8601 (datetime),\n                'datetime': datetime,\n                'lastTradeTimestamp': undefined,\n                'lastUpdateTimestamp': this.parse8601 (this.safeString (orderDictFromFetchOrder, 'lastUpdateTimestamp')),\n                'symbol': this.safeSymbol (this.safeString (orderDictFromFetchOrder, 'symbol'), market),\n                'type': undefined,\n                'timeInForce': undefined,\n                'postOnly': undefined,\n                'reduceOnly': this.safeBool (orderDictFromFetchOrder, 'reduceOnly'),\n                'side': this.safeString (orderDictFromFetchOrder, 'side'),\n                'price': this.safeString (orderDictFromFetchOrder, 'limitPrice'),\n                'triggerPrice': undefined,\n                'amount': this.safeString (orderDictFromFetchOrder, 'quantity'),\n                'cost': undefined,\n                'average': undefined,\n                'filled': this.safeString (orderDictFromFetchOrder, 'filled'),\n                'remaining': undefined,\n                'status': this.parseOrderStatus (innerStatus),\n                'fee': undefined,\n                'fees': undefined,\n                'trades': undefined,\n            });\n        }\n        const orderEvents = this.safeValue (order, 'orderEvents', []);\n        const errorStatus = this.safeString (order, 'status');\n        const orderEventsLength = orderEvents.length;\n        if (('orderEvents' in order) && (errorStatus !== undefined) && (orderEventsLength === 0)) {\n            // creteOrders error response\n            return this.safeOrder ({ 'info': order, 'status': 'rejected' });\n        }\n        let details = undefined;\n        let isPrior = false;\n        let fixed = false;\n        let statusId = undefined;\n        let price = undefined;\n        let trades = [];\n        if (orderEventsLength) {\n            const executions = [];\n            for (let i = 0; i < orderEvents.length; i++) {\n                const item = orderEvents[i];\n                if (this.safeString (item, 'type') === 'EXECUTION') {\n                    executions.push (item);\n                }\n                // Final order (after placement / editing / execution / canceling)\n                const orderTrigger = this.safeValue (item, 'orderTrigger');\n                if (details === undefined) {\n                    details = this.safeValue2 (item, 'new', 'order', orderTrigger);\n                    if (details !== undefined) {\n                        isPrior = false;\n                        fixed = true;\n                    } else if (!fixed) {\n                        const orderPriorExecution = this.safeValue (item, 'orderPriorExecution');\n                        details = this.safeValue2 (item, 'orderPriorExecution', 'orderPriorEdit');\n                        price = this.safeString (orderPriorExecution, 'limitPrice');\n                        if (details !== undefined) {\n                            isPrior = true;\n                        }\n                    }\n                }\n            }\n            trades = this.parseTrades (executions);\n            statusId = this.safeString (order, 'status');\n        }\n        if (details === undefined) {\n            details = order;\n        }\n        if (statusId === undefined) {\n            statusId = this.safeString (details, 'status');\n        }\n        // This may be incorrectly marked as \"open\" if only execution report is given,\n        // but will be fixed below\n        let status = this.parseOrderStatus (statusId);\n        let isClosed = this.inArray (status, [ 'canceled', 'rejected', 'closed' ]);\n        const marketId = this.safeString (details, 'symbol');\n        market = this.safeMarket (marketId, market);\n        const timestamp = this.parse8601 (this.safeString2 (details, 'timestamp', 'receivedTime'));\n        const lastUpdateTimestamp = this.parse8601 (this.safeString (details, 'lastUpdateTime'));\n        if (price === undefined) {\n            price = this.safeString (details, 'limitPrice');\n        }\n        let amount = this.safeString (details, 'quantity');\n        let filled = this.safeString2 (details, 'filledSize', 'filled', '0.0');\n        let remaining = this.safeString (details, 'unfilledSize');\n        let average = undefined;\n        let filled2 = '0.0';\n        const tradesLength = trades.length;\n        if (tradesLength > 0) {\n            let vwapSum = '0.0';\n            for (let i = 0; i < trades.length; i++) {\n                const trade = trades[i];\n                const tradeAmount = this.safeString (trade, 'amount');\n                const tradePrice = this.safeString (trade, 'price');\n                filled2 = Precise.stringAdd (filled2, tradeAmount);\n                vwapSum = Precise.stringAdd (vwapSum, Precise.stringMul (tradeAmount, tradePrice));\n            }\n            average = Precise.stringDiv (vwapSum, filled2);\n            if ((amount !== undefined) && (!isClosed) && isPrior && Precise.stringGe (filled2, amount)) {\n                status = 'closed';\n                isClosed = true;\n            }\n            if (isPrior) {\n                filled = Precise.stringAdd (filled, filled2);\n            } else {\n                filled = Precise.stringMax (filled, filled2);\n            }\n        }\n        if (remaining === undefined) {\n            if (isPrior) {\n                if (amount !== undefined) {\n                    // remaining amount before execution minus executed amount\n                    remaining = Precise.stringSub (amount, filled2);\n                }\n            } else {\n                remaining = amount;\n            }\n        }\n        // if fetchOpenOrders are parsed\n        if ((amount === undefined) && (!isPrior) && (remaining !== undefined)) {\n            amount = Precise.stringAdd (filled, remaining);\n        }\n        let cost = undefined;\n        if ((filled !== undefined) && (market !== undefined)) {\n            const whichPrice = (average !== undefined) ? average : price;\n            if (whichPrice !== undefined) {\n                if (market['linear']) {\n                    cost = Precise.stringMul (filled, whichPrice); // in quote\n                } else {\n                    cost = Precise.stringDiv (filled, whichPrice); // in base\n                }\n            }\n        }\n        let id = this.safeString2 (order, 'order_id', 'orderId');\n        if (id === undefined) {\n            id = this.safeString2 (details, 'orderId', 'uid');\n        }\n        const type = this.safeStringLower2 (details, 'type', 'orderType');\n        let timeInForce = 'gtc';\n        if (type === 'ioc' || this.parseOrderType (type) === 'market') {\n            timeInForce = 'ioc';\n        }\n        let symbol = this.safeString (market, 'symbol');\n        if ('tradeable' in details) {\n            symbol = this.safeSymbol (this.safeString (details, 'tradeable'), market);\n        }\n        const ts = this.safeInteger (details, 'timestamp', timestamp);\n        return this.safeOrder ({\n            'info': order,\n            'id': id,\n            'clientOrderId': this.safeStringN (details, [ 'clientOrderId', 'clientId', 'cliOrdId' ]),\n            'timestamp': ts,\n            'datetime': this.iso8601 (ts),\n            'lastTradeTimestamp': undefined,\n            'lastUpdateTimestamp': this.safeInteger (details, 'lastUpdateTimestamp', lastUpdateTimestamp),\n            'symbol': symbol,\n            'type': this.parseOrderType (type),\n            'timeInForce': timeInForce,\n            'postOnly': type === 'post',\n            'reduceOnly': this.safeBool2 (details, 'reduceOnly', 'reduce_only'),\n            'side': this.safeStringLower2 (details, 'side', 'direction'),\n            'price': price,\n            'triggerPrice': this.safeString (details, 'triggerPrice'),\n            'amount': amount,\n            'cost': cost,\n            'average': average,\n            'filled': filled,\n            'remaining': remaining,\n            'status': status,\n            'fee': undefined,\n            'fees': undefined,\n            'trades': trades,\n        });\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [],
      "line_end" => 1699,
      "line_start" => 1663,
      "mappings" => [],
      "name" => "parseOrderStatus",
      "signature" => "parseOrderStatus (status: Str)",
      "source" => "parseOrderStatus (status: Str) {\n        const statuses: Dict = {\n            'placed': 'open', // the order was placed successfully\n            'cancelled': 'canceled', // the order was cancelled successfully\n            'invalidOrderType': 'rejected', // the order was not placed because orderType is invalid\n            'invalidSide': 'rejected', // the order was not placed because side is invalid\n            'invalidSize': 'rejected', // the order was not placed because size is invalid\n            'invalidPrice': 'rejected', // the order was not placed because limitPrice and/or stopPrice are invalid\n            'insufficientAvailableFunds': 'rejected', // the order was not placed because available funds are insufficient\n            'selfFill': 'rejected', // the order was not placed because it would be filled against an existing order belonging to the same account\n            'tooManySmallOrders': 'rejected', // the order was not placed because the number of small open orders would exceed the permissible limit\n            'maxPositionViolation': 'rejected', // Order would cause you to exceed your maximum position in this contract.\n            'marketSuspended': 'rejected', // the order was not placed because the market is suspended\n            'marketInactive': 'rejected', // the order was not placed because the market is inactive\n            'clientOrderIdAlreadyExist': 'rejected', // the specified client id already exist\n            'clientOrderIdTooLong': 'rejected', // the client id is longer than the permissible limit\n            'outsidePriceCollar': 'rejected', // the limit order crosses the spread but is an order of magnitude away from the mark price - fat finger control\n            // Should the next two be 'expired' ?\n            'postWouldExecute': 'rejected', // the post-only order would be filled upon placement, thus is cancelled\n            'iocWouldNotExecute': 'rejected', // the immediate-or-cancel order would not execute.\n            'wouldNotReducePosition': 'rejected', // the reduce only order would not reduce position.\n            'edited': 'open', // the order was edited successfully\n            'orderForEditNotFound': 'rejected', // the requested order for edit has not been found\n            'orderForEditNotAStop': 'rejected', // the supplied stopPrice cannot be applied because order is not a stop order\n            'filled': 'closed', // the order was found completely filled and could not be cancelled\n            'notFound': 'rejected', // the order was not found, either because it had already been cancelled or it never existed\n            'untouched': 'open', // the entire size of the order is unfilled\n            'partiallyFilled': 'open', // the size of the order is partially but not entirely filled\n            'ENTERED_BOOK': 'open',\n            'FULLY_EXECUTED': 'closed',\n            'CANCELLED': 'canceled',\n            'TRIGGER_PLACED': 'open',\n            'PARTIALLY_FILLED': 'open',\n            'UNTOUCHED': 'open',\n        };\n        return this.safeString (statuses, status, status);\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [],
      "line_end" => 1633,
      "line_start" => 1625,
      "mappings" => [],
      "name" => "parseOrderType",
      "signature" => "parseOrderType (orderType)",
      "source" => "parseOrderType (orderType) {\n        const typesMap: Dict = {\n            'lmt': 'limit',\n            'mkt': 'market',\n            'post': 'limit',\n            'ioc': 'market',\n        };\n        return this.safeString (typesMap, orderType, orderType);\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"side\": \"long\",\n        \"symbol\": \"pi_xrpusd\",\n        \"price\": \"0.7533\",\n        \"fillTime\": \"2022-03-03T22:51:16.566Z\",\n        \"size\": \"230\",\n        \"unrealizedFunding\": \"-0.001878596918214635\"\n    }",
        "{\n        \"side\":\"long\",\n        \"symbol\":\"pf_ftmusd\",\n        \"price\":\"0.4921\",\n        \"fillTime\":\"2023-02-22T11:37:16.685Z\",\n        \"size\":\"1\",\n        \"unrealizedFunding\":\"-8.155240068885155E-8\",\n        \"pnlCurrency\":\"USD\",\n        \"maxFixedLeverage\":\"1.0\"\n    }"
      ],
      "line_end" => 2666,
      "line_start" => 2612,
      "mappings" => [
        %{
          "comment" => nil,
          "key" => "info",
          "value" => "position"
        },
        %{
          "comment" => nil,
          "key" => "symbol",
          "value" => "market['symbol']"
        },
        %{
          "comment" => nil,
          "key" => "timestamp",
          "value" => "this.parse8601 (datetime)"
        },
        %{
          "comment" => nil,
          "key" => "datetime",
          "value" => "datetime"
        },
        %{
          "comment" => nil,
          "key" => "initialMargin",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "initialMarginPercentage",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "maintenanceMargin",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "maintenanceMarginPercentage",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "entryPrice",
          "value" => "this.safeNumber (position, 'price')"
        },
        %{
          "comment" => nil,
          "key" => "notional",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "leverage",
          "value" => "leverage"
        },
        %{
          "comment" => nil,
          "key" => "unrealizedPnl",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "contracts",
          "value" => "this.safeNumber (position, 'size')"
        },
        %{
          "comment" => nil,
          "key" => "contractSize",
          "value" => "this.safeNumber (market, 'contractSize')"
        },
        %{
          "comment" => nil,
          "key" => "marginRatio",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "liquidationPrice",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "markPrice",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "collateral",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "marginType",
          "value" => "marginType"
        },
        %{
          "comment" => nil,
          "key" => "side",
          "value" => "this.safeString (position, 'side')"
        },
        %{
          "comment" => nil,
          "key" => "percentage",
          "value" => "undefined"
        }
      ],
      "name" => "parsePosition",
      "signature" => "parsePosition (position: Dict, market: Market = undefined)",
      "source" => "parsePosition (position: Dict, market: Market = undefined) {\n        // cross\n        //    {\n        //        \"side\": \"long\",\n        //        \"symbol\": \"pi_xrpusd\",\n        //        \"price\": \"0.7533\",\n        //        \"fillTime\": \"2022-03-03T22:51:16.566Z\",\n        //        \"size\": \"230\",\n        //        \"unrealizedFunding\": \"-0.001878596918214635\"\n        //    }\n        //\n        // isolated\n        //    {\n        //        \"side\":\"long\",\n        //        \"symbol\":\"pf_ftmusd\",\n        //        \"price\":\"0.4921\",\n        //        \"fillTime\":\"2023-02-22T11:37:16.685Z\",\n        //        \"size\":\"1\",\n        //        \"unrealizedFunding\":\"-8.155240068885155E-8\",\n        //        \"pnlCurrency\":\"USD\",\n        //        \"maxFixedLeverage\":\"1.0\"\n        //    }\n        //\n        const leverage = this.safeNumber (position, 'maxFixedLeverage');\n        let marginType = 'cross';\n        if (leverage !== undefined) {\n            marginType = 'isolated';\n        }\n        const datetime = this.safeString (position, 'fillTime');\n        const marketId = this.safeString (position, 'symbol');\n        market = this.safeMarket (marketId, market);\n        return {\n            'info': position,\n            'symbol': market['symbol'],\n            'timestamp': this.parse8601 (datetime),\n            'datetime': datetime,\n            'initialMargin': undefined,\n            'initialMarginPercentage': undefined,\n            'maintenanceMargin': undefined,\n            'maintenanceMarginPercentage': undefined,\n            'entryPrice': this.safeNumber (position, 'price'),\n            'notional': undefined,\n            'leverage': leverage,\n            'unrealizedPnl': undefined,\n            'contracts': this.safeNumber (position, 'size'),\n            'contractSize': this.safeNumber (market, 'contractSize'),\n            'marginRatio': undefined,\n            'liquidationPrice': undefined,\n            'markPrice': undefined,\n            'collateral': undefined,\n            'marginType': marginType,\n            'side': this.safeString (position, 'side'),\n            'percentage': undefined,\n        };\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [],
      "line_end" => 2610,
      "line_start" => 2602,
      "mappings" => [],
      "name" => "parsePositions",
      "signature" => "parsePositions (response, symbols: Strings = undefined, params = {})",
      "source" => "parsePositions (response, symbols: Strings = undefined, params = {}) {\n        const result = [];\n        const positions = this.safeValue (response, 'openPositions');\n        for (let i = 0; i < positions.length; i++) {\n            const position = this.parsePosition (positions[i]);\n            result.push (position);\n        }\n        return result;\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"tag\": 'semiannual',  // 'month', 'quarter', \"perpetual\", \"semiannual\",\n        \"pair\": \"ETH:USD\",\n        \"symbol\": \"fi_ethusd_220624\",\n        \"markPrice\": \"2925.72\",\n        \"bid\": \"2923.8\",\n        \"bidSize\": \"16804\",\n        \"ask\": \"2928.65\",\n        \"askSize\": \"1339\",\n        \"vol24h\": \"860493\",\n        \"openInterest\": \"3023363.00000000\",\n        \"open24h\": \"3021.25\",\n        \"indexPrice\": \"2893.71\",\n        \"last\": \"2942.25\",\n        \"lastTime\": \"2022-02-18T14:08:15.578Z\",\n        \"lastSize\": \"151\",\n        \"suspended\": false\n    }",
        "{\n        \"symbol\": \"in_xbtusd\", // \"rr_xbtusd\",\n        \"last\": \"40411\",\n        \"lastTime\": \"2022-02-18T14:16:28.000Z\"\n    }"
      ],
      "line_end" => 711,
      "line_start" => 640,
      "mappings" => [
        %{
          "comment" => nil,
          "key" => "symbol",
          "value" => "symbol"
        },
        %{
          "comment" => nil,
          "key" => "timestamp",
          "value" => "timestamp"
        },
        %{
          "comment" => nil,
          "key" => "datetime",
          "value" => "this.iso8601 (timestamp)"
        },
        %{
          "comment" => nil,
          "key" => "high",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "low",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "bid",
          "value" => "this.safeString (ticker, 'bid')"
        },
        %{
          "comment" => nil,
          "key" => "bidVolume",
          "value" => "this.safeString (ticker, 'bidSize')"
        },
        %{
          "comment" => nil,
          "key" => "ask",
          "value" => "this.safeString (ticker, 'ask')"
        },
        %{
          "comment" => nil,
          "key" => "askVolume",
          "value" => "this.safeString (ticker, 'askSize')"
        },
        %{
          "comment" => nil,
          "key" => "vwap",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "open",
          "value" => "open"
        },
        %{
          "comment" => nil,
          "key" => "close",
          "value" => "last"
        },
        %{
          "comment" => nil,
          "key" => "last",
          "value" => "last"
        },
        %{
          "comment" => nil,
          "key" => "previousClose",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "change",
          "value" => "change"
        },
        %{
          "comment" => nil,
          "key" => "percentage",
          "value" => "percentage"
        },
        %{
          "comment" => nil,
          "key" => "average",
          "value" => "average"
        },
        %{
          "comment" => nil,
          "key" => "baseVolume",
          "value" => "baseVolume"
        },
        %{
          "comment" => nil,
          "key" => "quoteVolume",
          "value" => "quoteVolume"
        },
        %{
          "comment" => nil,
          "key" => "markPrice",
          "value" => "this.safeString (ticker, 'markPrice')"
        },
        %{
          "comment" => nil,
          "key" => "indexPrice",
          "value" => "this.safeString (ticker, 'indexPrice')"
        },
        %{
          "comment" => nil,
          "key" => "info",
          "value" => "ticker"
        }
      ],
      "name" => "parseTicker",
      "signature" => "parseTicker (ticker: Dict, market: Market = undefined): Ticker",
      "source" => "parseTicker (ticker: Dict, market: Market = undefined): Ticker {\n        //\n        //    {\n        //        \"tag\": 'semiannual',  // 'month', 'quarter', \"perpetual\", \"semiannual\",\n        //        \"pair\": \"ETH:USD\",\n        //        \"symbol\": \"fi_ethusd_220624\",\n        //        \"markPrice\": \"2925.72\",\n        //        \"bid\": \"2923.8\",\n        //        \"bidSize\": \"16804\",\n        //        \"ask\": \"2928.65\",\n        //        \"askSize\": \"1339\",\n        //        \"vol24h\": \"860493\",\n        //        \"openInterest\": \"3023363.00000000\",\n        //        \"open24h\": \"3021.25\",\n        //        \"indexPrice\": \"2893.71\",\n        //        \"last\": \"2942.25\",\n        //        \"lastTime\": \"2022-02-18T14:08:15.578Z\",\n        //        \"lastSize\": \"151\",\n        //        \"suspended\": false\n        //    }\n        //\n        //    {\n        //        \"symbol\": \"in_xbtusd\", // \"rr_xbtusd\",\n        //        \"last\": \"40411\",\n        //        \"lastTime\": \"2022-02-18T14:16:28.000Z\"\n        //    }\n        //\n        const marketId = this.safeString (ticker, 'symbol');\n        market = this.safeMarket (marketId, market);\n        const symbol = market['symbol'];\n        const timestamp = this.parse8601 (this.safeString (ticker, 'lastTime'));\n        const open = this.safeString (ticker, 'open24h');\n        const last = this.safeString (ticker, 'last');\n        const change = Precise.stringSub (last, open);\n        const percentage = Precise.stringMul (Precise.stringDiv (change, open), '100');\n        const average = Precise.stringDiv (Precise.stringAdd (open, last), '2');\n        const volume = this.safeString (ticker, 'vol24h');\n        let baseVolume = undefined;\n        let quoteVolume = undefined;\n        const isIndex = this.safeBool (market, 'index', false);\n        if (!isIndex) {\n            if (market['linear']) {\n                baseVolume = volume;\n            } else if (market['inverse']) {\n                quoteVolume = volume;\n            }\n        }\n        return this.safeTicker ({\n            'symbol': symbol,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'high': undefined,\n            'low': undefined,\n            'bid': this.safeString (ticker, 'bid'),\n            'bidVolume': this.safeString (ticker, 'bidSize'),\n            'ask': this.safeString (ticker, 'ask'),\n            'askVolume': this.safeString (ticker, 'askSize'),\n            'vwap': undefined,\n            'open': open,\n            'close': last,\n            'last': last,\n            'previousClose': undefined,\n            'change': change,\n            'percentage': percentage,\n            'average': average,\n            'baseVolume': baseVolume,\n            'quoteVolume': quoteVolume,\n            'markPrice': this.safeString (ticker, 'markPrice'),\n            'indexPrice': this.safeString (ticker, 'indexPrice'),\n            'info': ticker,\n        });\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"time\": \"2019-02-14T09:25:33.920Z\",\n        \"trade_id\": 100,\n        \"price\": 3574,\n        \"size\": 100,\n        \"side\": \"buy\",\n        \"type\": \"fill\" // fill, liquidation, assignment, termination\n        \"uid\": \"11c3d82c-9e70-4fe9-8115-f643f1b162d4\"\n    }",
        "{\n        \"timestamp\": \"1710152516830\",\n        \"price\": \"71927.0\",\n        \"quantity\": \"0.0695\",\n        \"markPrice\": \"71936.38701675525\",\n        \"limitFilled\": true,\n        \"usdValue\": \"4998.93\",\n        \"uid\": \"116ae634-253f-470b-bd20-fa9d429fb8b1\",\n        \"makerOrder\": { \"uid\": \"17bfe4de-c01e-4938-926c-617d2a2d0597\", \"tradeable\": \"PF_XBTUSD\", \"direction\": \"Buy\", \"quantity\": \"0.0695\", \"timestamp\": \"1710152515836\", \"limitPrice\": \"71927.0\", \"orderType\": \"Post\", \"reduceOnly\": false, \"lastUpdateTimestamp\": \"1710152515836\" },\n        \"takerOrder\": { \"uid\": \"d3e437b4-aa70-4108-b5cf-b1eecb9845b5\", \"tradeable\": \"PF_XBTUSD\", \"direction\": \"Sell\", \"quantity\": \"0.940100\", \"timestamp\": \"1710152516830\", \"limitPrice\": \"71915\", \"orderType\": \"IoC\", \"reduceOnly\": false, \"lastUpdateTimestamp\": \"1710152516830\" }\n    }",
        "{\n        \"fillTime\": \"2016-02-25T09:47:01.000Z\",\n        \"order_id\": \"c18f0c17-9971-40e6-8e5b-10df05d422f0\",\n        \"fill_id\": \"522d4e08-96e7-4b44-9694-bfaea8fe215e\",\n        \"cliOrdId\": \"d427f920-ec55-4c18-ba95-5fe241513b30\",     // OPTIONAL\n        \"symbol\": \"fi_xbtusd_180615\",\n        \"side\": \"buy\",\n        \"size\": 2000,\n        \"price\": 4255,\n        \"fillType\": \"maker\"                                     // taker, takerAfterEdit, maker, liquidation, assignee\n    }",
        "{\n        \"executionId\": \"e1ec9f63-2338-4c44-b40a-43486c6732d7\",\n        \"price\": 7244.5,\n        \"amount\": 10,\n        \"orderPriorEdit\": null,\n        \"orderPriorExecution\": {\n            \"orderId\": \"61ca5732-3478-42fe-8362-abbfd9465294\",\n            \"cliOrdId\": null,\n            \"type\": \"lmt\",\n            \"symbol\": \"pi_xbtusd\",\n            \"side\": \"buy\",\n            \"quantity\": 10,\n            \"filled\": 0,\n            \"limitPrice\": 7500,\n            \"reduceOnly\": false,\n            \"timestamp\": \"2019-12-11T17:17:33.888Z\",\n            \"lastUpdateTimestamp\": \"2019-12-11T17:17:33.888Z\"\n        },\n        \"takerReducedQuantity\": null,\n        \"type\": \"EXECUTION\"\n    }"
      ],
      "line_end" => 1062,
      "line_start" => 924,
      "mappings" => [
        %{
          "comment" => nil,
          "key" => "info",
          "value" => "trade"
        },
        %{
          "comment" => nil,
          "key" => "id",
          "value" => "id"
        },
        %{
          "comment" => nil,
          "key" => "symbol",
          "value" => "this.safeString (market, 'symbol')"
        },
        %{
          "comment" => nil,
          "key" => "timestamp",
          "value" => "timestamp"
        },
        %{
          "comment" => nil,
          "key" => "datetime",
          "value" => "this.iso8601 (timestamp)"
        },
        %{
          "comment" => nil,
          "key" => "order",
          "value" => "order"
        },
        %{
          "comment" => nil,
          "key" => "type",
          "value" => "type"
        },
        %{
          "comment" => nil,
          "key" => "side",
          "value" => "side"
        },
        %{
          "comment" => nil,
          "key" => "takerOrMaker",
          "value" => "takerOrMaker"
        },
        %{
          "comment" => nil,
          "key" => "price",
          "value" => "price"
        },
        %{
          "comment" => nil,
          "key" => "amount",
          "value" => "linear ? amount : undefined"
        },
        %{
          "comment" => nil,
          "key" => "cost",
          "value" => "cost"
        },
        %{
          "comment" => nil,
          "key" => "fee",
          "value" => "undefined"
        }
      ],
      "name" => "parseTrade",
      "signature" => "parseTrade (trade: Dict, market: Market = undefined): Trade",
      "source" => "parseTrade (trade: Dict, market: Market = undefined): Trade {\n        //\n        // fetchTrades (recent trades)\n        //\n        //    {\n        //        \"time\": \"2019-02-14T09:25:33.920Z\",\n        //        \"trade_id\": 100,\n        //        \"price\": 3574,\n        //        \"size\": 100,\n        //        \"side\": \"buy\",\n        //        \"type\": \"fill\" // fill, liquidation, assignment, termination\n        //        \"uid\": \"11c3d82c-9e70-4fe9-8115-f643f1b162d4\"\n        //    }\n        //\n        // fetchTrades (executions history)\n        //\n        //    {\n        //        \"timestamp\": \"1710152516830\",\n        //        \"price\": \"71927.0\",\n        //        \"quantity\": \"0.0695\",\n        //        \"markPrice\": \"71936.38701675525\",\n        //        \"limitFilled\": true,\n        //        \"usdValue\": \"4998.93\",\n        //        \"uid\": \"116ae634-253f-470b-bd20-fa9d429fb8b1\",\n        //        \"makerOrder\": { \"uid\": \"17bfe4de-c01e-4938-926c-617d2a2d0597\", \"tradeable\": \"PF_XBTUSD\", \"direction\": \"Buy\", \"quantity\": \"0.0695\", \"timestamp\": \"1710152515836\", \"limitPrice\": \"71927.0\", \"orderType\": \"Post\", \"reduceOnly\": false, \"lastUpdateTimestamp\": \"1710152515836\" },\n        //        \"takerOrder\": { \"uid\": \"d3e437b4-aa70-4108-b5cf-b1eecb9845b5\", \"tradeable\": \"PF_XBTUSD\", \"direction\": \"Sell\", \"quantity\": \"0.940100\", \"timestamp\": \"1710152516830\", \"limitPrice\": \"71915\", \"orderType\": \"IoC\", \"reduceOnly\": false, \"lastUpdateTimestamp\": \"1710152516830\" }\n        //    }\n        //\n        // fetchMyTrades (private)\n        //\n        //    {\n        //        \"fillTime\": \"2016-02-25T09:47:01.000Z\",\n        //        \"order_id\": \"c18f0c17-9971-40e6-8e5b-10df05d422f0\",\n        //        \"fill_id\": \"522d4e08-96e7-4b44-9694-bfaea8fe215e\",\n        //        \"cliOrdId\": \"d427f920-ec55-4c18-ba95-5fe241513b30\",     // OPTIONAL\n        //        \"symbol\": \"fi_xbtusd_180615\",\n        //        \"side\": \"buy\",\n        //        \"size\": 2000,\n        //        \"price\": 4255,\n        //        \"fillType\": \"maker\"                                     // taker, takerAfterEdit, maker, liquidation, assignee\n        //    }\n        //\n        // execution report (createOrder, editOrder)\n        //\n        //    {\n        //        \"executionId\": \"e1ec9f63-2338-4c44-b40a-43486c6732d7\",\n        //        \"price\": 7244.5,\n        //        \"amount\": 10,\n        //        \"orderPriorEdit\": null,\n        //        \"orderPriorExecution\": {\n        //            \"orderId\": \"61ca5732-3478-42fe-8362-abbfd9465294\",\n        //            \"cliOrdId\": null,\n        //            \"type\": \"lmt\",\n        //            \"symbol\": \"pi_xbtusd\",\n        //            \"side\": \"buy\",\n        //            \"quantity\": 10,\n        //            \"filled\": 0,\n        //            \"limitPrice\": 7500,\n        //            \"reduceOnly\": false,\n        //            \"timestamp\": \"2019-12-11T17:17:33.888Z\",\n        //            \"lastUpdateTimestamp\": \"2019-12-11T17:17:33.888Z\"\n        //        },\n        //        \"takerReducedQuantity\": null,\n        //        \"type\": \"EXECUTION\"\n        //    }\n        //\n        let timestamp = this.parse8601 (this.safeString2 (trade, 'time', 'fillTime'));\n        const price = this.safeString (trade, 'price');\n        const amount = this.safeStringN (trade, [ 'size', 'amount', 'quantity' ], '0.0');\n        let id = this.safeString2 (trade, 'uid', 'fill_id');\n        if (id === undefined) {\n            id = this.safeString (trade, 'executionId');\n        }\n        let order = this.safeString (trade, 'order_id');\n        let marketId = this.safeString (trade, 'symbol');\n        let side = this.safeString (trade, 'side');\n        let type = undefined;\n        const priorEdit = this.safeValue (trade, 'orderPriorEdit');\n        const priorExecution = this.safeValue (trade, 'orderPriorExecution');\n        if (priorExecution !== undefined) {\n            order = this.safeString (priorExecution, 'orderId');\n            marketId = this.safeString (priorExecution, 'symbol');\n            side = this.safeString (priorExecution, 'side');\n            type = this.safeString (priorExecution, 'type');\n        } else if (priorEdit !== undefined) {\n            order = this.safeString (priorEdit, 'orderId');\n            marketId = this.safeString (priorEdit, 'symbol');\n            side = this.safeString (priorEdit, 'type');\n            type = this.safeString (priorEdit, 'type');\n        }\n        if (type !== undefined) {\n            type = this.parseOrderType (type);\n        }\n        market = this.safeMarket (marketId, market);\n        let cost = undefined;\n        const linear = this.safeBool (market, 'linear');\n        if ((amount !== undefined) && (price !== undefined) && (market !== undefined)) {\n            if (linear) {\n                cost = Precise.stringMul (amount, price); // in quote\n            } else {\n                cost = Precise.stringDiv (amount, price); // in base\n            }\n            const contractSize = this.safeString (market, 'contractSize');\n            cost = Precise.stringMul (cost, contractSize);\n        }\n        let takerOrMaker = undefined;\n        const fillType = this.safeString (trade, 'fillType');\n        if (fillType !== undefined) {\n            if (fillType.indexOf ('taker') >= 0) {\n                takerOrMaker = 'taker';\n            } else if (fillType.indexOf ('maker') >= 0) {\n                takerOrMaker = 'maker';\n            }\n        }\n        const isHistoricalExecution = ('takerOrder' in trade);\n        if (isHistoricalExecution) {\n            timestamp = this.safeInteger (trade, 'timestamp');\n            const taker = this.safeDict (trade, 'takerOrder', {});\n            if (taker !== undefined) {\n                side = this.safeStringLower (taker, 'direction');\n                takerOrMaker = 'taker';\n            }\n        }\n        return this.safeTrade ({\n            'info': trade,\n            'id': id,\n            'symbol': this.safeString (market, 'symbol'),\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'order': order,\n            'type': type,\n            'side': side,\n            'takerOrMaker': takerOrMaker,\n            'price': price,\n            'amount': linear ? amount : undefined,\n            'cost': cost,\n            'fee': undefined,\n        });\n    }"
    },
    %{
      "comment" => nil,
      "examples" => [
        "{\n        \"result\": \"success\",\n        \"serverTime\": \"2022-04-12T01:22:53.420Z\"\n    }"
      ],
      "line_end" => 2819,
      "line_start" => 2798,
      "mappings" => [
        %{
          "comment" => nil,
          "key" => "info",
          "value" => "transfer"
        },
        %{
          "comment" => nil,
          "key" => "id",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "timestamp",
          "value" => "this.parse8601 (datetime)"
        },
        %{
          "comment" => nil,
          "key" => "datetime",
          "value" => "datetime"
        },
        %{
          "comment" => nil,
          "key" => "currency",
          "value" => "this.safeString (currency, 'code')"
        },
        %{
          "comment" => nil,
          "key" => "amount",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "fromAccount",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "toAccount",
          "value" => "undefined"
        },
        %{
          "comment" => nil,
          "key" => "status",
          "value" => "this.safeString (transfer, 'result')"
        }
      ],
      "name" => "parseTransfer",
      "signature" => "parseTransfer (transfer: Dict, currency: Currency = undefined): TransferEntry",
      "source" => "parseTransfer (transfer: Dict, currency: Currency = undefined): TransferEntry {\n        //\n        // transfer\n        //\n        //    {\n        //        \"result\": \"success\",\n        //        \"serverTime\": \"2022-04-12T01:22:53.420Z\"\n        //    }\n        //\n        const datetime = this.safeString (transfer, 'serverTime');\n        return {\n            'info': transfer,\n            'id': undefined,\n            'timestamp': this.parse8601 (datetime),\n            'datetime': datetime,\n            'currency': this.safeString (currency, 'code'),\n            'amount': undefined,\n            'fromAccount': undefined,\n            'toAccount': undefined,\n            'status': this.safeString (transfer, 'result'),\n        };\n    }"
    }
  ],
  path_prefix: "v3/",
  pro: true,
  quote_json_numbers: nil,
  rate_limits: %{
    interval_ms: 600,
    period: 1000,
    requests: 1,
    rolling_window_size: 60000
  },
  raw_endpoints: %{
    private: [],
    public: []
  },
  required_credentials: %{
    api_key: true,
    password: false,
    secret: true,
    uid: false
  },
  requires_eddsa: false,
  response_error: nil,
  signing: %{
    api_key_header: "APIKey",
    confidence: :high,
    pattern: :hmac_sha512_nonce,
    signature_encoding: :base64,
    signature_header: "Authent"
  },
  spec_format_version: 1,
  status: %{
    "eta" => nil,
    "status" => "ok",
    "updated" => nil,
    "url" => nil
  },
  symbol_format: nil,
  symbol_formats: %{
    future: %{
      base: "ETH",
      base_id: "ETH",
      case: :upper,
      contract: true,
      contract_size: 1,
      expiry: 1774598400000,
      expiry_datetime: "2026-03-27T08:00:00.000Z",
      id: "FF_ETHUSD_260327",
      inverse: false,
      limits: %{
        "amount" => %{},
        "cost" => %{},
        "leverage" => %{},
        "price" => %{}
      },
      linear: true,
      maker: 0.0002,
      precision: %{
        "amount" => 0.001,
        "price" => 0.1
      },
      quote: "USD",
      quote_id: "usd",
      separator: "_",
      settle: "USD",
      settle_id: "usd",
      symbol: "ETH/USD:USD-260327",
      taker: 0.0005
    },
    precision_mode: 4,
    sample_limits: %{
      "amount" => %{},
      "cost" => %{},
      "price" => %{}
    },
    sample_precision: %{
      "amount" => 1,
      "price" => 0.5
    },
    swap: %{
      base: "BTC",
      base_id: "XBT",
      case: :upper,
      contract: true,
      contract_size: 1,
      id: "PI_XBTUSD",
      inverse: true,
      limits: %{
        "amount" => %{},
        "cost" => %{},
        "leverage" => %{},
        "price" => %{}
      },
      linear: false,
      maker: 0.0002,
      precision: %{
        "amount" => 1,
        "price" => 0.5
      },
      quote: "USD",
      quote_id: "usd",
      separator: "_",
      settle: "BTC",
      settle_id: "XBT",
      symbol: "BTC/USD:BTC",
      taker: 0.0005
    }
  },
  symbol_patterns: %{
    future: %{
      case: :upper,
      component_order: [
        :base,
        :quote,
        :date
      ],
      date_format: :yymmdd,
      pattern: :future_yymmdd,
      separator: "_",
      suffix: nil
    },
    swap: %{
      case: :upper,
      component_order: nil,
      date_format: nil,
      pattern: :implicit,
      separator: "_",
      suffix: nil
    }
  },
  timeframes: %{
    "12h" => "12h",
    "15m" => "15m",
    "1d" => "1d",
    "1h" => "1h",
    "1m" => "1m",
    "1w" => "1w",
    "30m" => "30m",
    "4h" => "4h",
    "5m" => "5m"
  },
  url_strategy: %{
    detected_from: "sign_method",
    pattern: :version_slash_no_leading,
    prefix: "v3/"
  },
  urls: %{
    api: "https://futures.kraken.com/derivatives/api/",
    api_sections: %{
      "charts" => "https://futures.kraken.com/api/charts/",
      "feeschedules" => "https://futures.kraken.com/api/feeschedules/",
      "history" => "https://futures.kraken.com/api/history/",
      "private" => "https://futures.kraken.com/derivatives/api/",
      "public" => "https://futures.kraken.com/derivatives/api/"
    },
    doc: [
      "https://docs.kraken.com/api/docs/futures-api/trading/market-data/"
    ],
    other: nil,
    sandbox: %{
      "charts" => "https://demo-futures.kraken.com/api/charts/",
      "history" => "https://demo-futures.kraken.com/api/history/",
      "private" => "https://demo-futures.kraken.com/derivatives/api/",
      "public" => "https://demo-futures.kraken.com/derivatives/api/",
      "www" => "https://demo-futures.kraken.com"
    },
    www: "https://futures.kraken.com/"
  },
  version: "v3",
  ws: %{
    channel_templates: %{
      watch_balance: %{
        channel_name: "balances",
        market_id_format: :native,
        params: [],
        pattern: :event_based
      },
      watch_bids_asks: %{
        market_id_format: :native,
        params: [],
        pattern: :event_based
      },
      watch_my_trades: %{
        channel_name: "fills",
        market_id_format: :native,
        params: [
          %{
            "default" => nil,
            "name" => "limit"
          }
        ],
        pattern: :event_based
      },
      watch_order_book: %{
        market_id_format: :native,
        params: [
          %{
            "default" => nil,
            "name" => "limit"
          }
        ],
        pattern: :event_based
      },
      watch_order_book_for_symbols: %{
        market_id_format: :native,
        params: [
          %{
            "default" => nil,
            "name" => "limit"
          }
        ],
        pattern: :event_based
      },
      watch_orders: %{
        channel_name: "open_orders",
        market_id_format: :native,
        params: [
          %{
            "default" => nil,
            "name" => "limit"
          }
        ],
        pattern: :event_based
      },
      watch_positions: %{
        market_id_format: :native,
        params: [
          %{
            "default" => nil,
            "name" => "limit"
          }
        ],
        pattern: :event_based
      },
      watch_ticker: %{
        market_id_format: :native,
        params: [],
        pattern: :event_based
      },
      watch_tickers: %{
        market_id_format: :native,
        params: [],
        pattern: :event_based
      },
      watch_trades: %{
        market_id_format: :native,
        params: [
          %{
            "default" => nil,
            "name" => "limit"
          }
        ],
        pattern: :event_based
      },
      watch_trades_for_symbols: %{
        market_id_format: :native,
        params: [
          %{
            "default" => nil,
            "name" => "limit"
          }
        ],
        pattern: :event_based
      }
    },
    has: %{
      watch_balance: true,
      watch_bids_asks: true,
      watch_liquidations: nil,
      watch_liquidations_for_symbols: nil,
      watch_my_liquidations: nil,
      watch_my_liquidations_for_symbols: nil,
      watch_my_trades: true,
      watch_ohlcv: false,
      watch_ohlcv_for_symbols: nil,
      watch_order_book: true,
      watch_order_book_for_symbols: true,
      watch_orders: true,
      watch_orders_for_symbols: nil,
      watch_position: nil,
      watch_positions: true,
      watch_status: nil,
      watch_ticker: true,
      watch_tickers: true,
      watch_trades: true,
      watch_trades_for_symbols: true
    },
    message_patterns: [
      %{
        format: :event,
        keys: [
          "api_key",
          "event"
        ],
        kind_field: "event",
        kind_value: "challenge",
        sources: [
          :send,
          :watch
        ]
      },
      %{
        format: :event,
        keys: [
          "api_key",
          "event",
          "feed"
        ],
        kind_field: "event",
        kind_value: "subscribe",
        sources: [
          :send,
          :watch
        ]
      },
      %{
        format: :event,
        keys: [
          "event",
          "feed",
          "product_ids"
        ],
        kind_field: "event",
        kind_value: "subscribe",
        sources: [
          :send,
          :watch_multiple
        ]
      }
    ],
    streaming: %{
      keep_alive: 30000
    },
    subscription_config: %{
      args_field: "channel",
      args_format: :string,
      market_id_format: :native,
      op_field: "event"
    },
    subscription_pattern: :event_subscribe,
    test_urls: "wss://demo-futures.kraken.com/ws/v1",
    urls: "wss://futures.kraken.com/ws/v1",
    watch_methods: [
      "watchBalance",
      "watchBidsAsks",
      "watchMyTrades",
      "watchOrderBook",
      "watchOrderBookForSymbols",
      "watchOrders",
      "watchPositions",
      "watchTicker",
      "watchTickers",
      "watchTrades",
      "watchTradesForSymbols"
    ]
  }
}
